<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1800" height="1400" viewBox="0 0 1800 1400">
  <defs>
    <style>
      .table-box { fill: #f8f9fa; stroke: #3498db; stroke-width: 2; }
      .table-title { fill: #3498db; font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; }
      .field-text { fill: #2c3e50; font-family: Arial, sans-serif; font-size: 11px; }
      .pk-field { fill: #e74c3c; font-weight: bold; }
      .fk-field { fill: #27ae60; }
      .uuid-field { fill: #9b59b6; font-weight: bold; }
      .relationship-line { stroke: #666; stroke-width: 1.5; fill: none; }
      .relationship-label { fill: #666; font-family: Arial, sans-serif; font-size: 10px; }
      .core-table { fill: #e8f4fd; stroke: #2980b9; stroke-width: 3; }
      .hardware-table { fill: #e8f8f5; stroke: #27ae60; stroke-width: 2; }
      .software-table { fill: #fef9e7; stroke: #f39c12; stroke-width: 2; }
      .message-table { fill: #f4ecf7; stroke: #8e44ad; stroke-width: 2; }
      .auth-table { fill: #fadbd8; stroke: #e74c3c; stroke-width: 2; }
      .security-note { fill: #d4edda; stroke: #27ae60; stroke-width: 2; stroke-dasharray: 5,5; }
    </style>
  </defs>

  <!-- Title -->
  <text x="900" y="30" text-anchor="middle" class="table-title" font-size="20">SysManage Database Schema - UUID-Based Entity Relationship Diagram</text>

  <!-- Security Feature Highlight -->
  <rect x="50" y="45" width="1700" height="25" class="security-note"/>
  <text x="900" y="62" text-anchor="middle" class="field-text" font-size="12" fill="#155724">🔐 Security Feature: All primary keys use UUID for enhanced security, preventing ID enumeration attacks</text>

  <!-- Core Tables Group -->
  <text x="50" y="100" class="table-title" font-size="16">Core Entities</text>

  <!-- User Table -->
  <rect x="50" y="110" width="200" height="300" class="table-box auth-table"/>
  <text x="150" y="130" text-anchor="middle" class="table-title">User</text>
  <text x="60" y="150" class="field-text uuid-field">🔑 id (UUID)</text>
  <text x="60" y="165" class="field-text">userid (String)</text>
  <text x="60" y="180" class="field-text">first_name (String)</text>
  <text x="60" y="195" class="field-text">last_name (String)</text>
  <text x="60" y="210" class="field-text">hashed_password (String)</text>
  <text x="60" y="225" class="field-text">active (Boolean)</text>
  <text x="60" y="240" class="field-text">is_admin (Boolean)</text>
  <text x="60" y="255" class="field-text">last_access (DateTime)</text>
  <text x="60" y="270" class="field-text">is_locked (Boolean)</text>
  <text x="60" y="285" class="field-text">failed_login_attempts (Integer)</text>
  <text x="60" y="300" class="field-text">locked_at (DateTime)</text>
  <text x="60" y="315" class="field-text">profile_image (LargeBinary)</text>
  <text x="60" y="330" class="field-text">profile_image_type (String)</text>
  <text x="60" y="345" class="field-text">profile_image_uploaded_at (DateTime)</text>
  <text x="60" y="360" class="field-text">created_at (DateTime)</text>
  <text x="60" y="375" class="field-text">updated_at (DateTime)</text>

  <!-- Host Table (Central) -->
  <rect x="320" y="110" width="280" height="480" class="table-box core-table"/>
  <text x="460" y="130" text-anchor="middle" class="table-title">Host (Central Entity)</text>
  <text x="330" y="150" class="field-text uuid-field">🔑 id (UUID)</text>
  <text x="330" y="165" class="field-text">host_token (String, Unique)</text>
  <text x="330" y="180" class="field-text">active (Boolean)</text>
  <text x="330" y="195" class="field-text">approved (Boolean)</text>
  <text x="330" y="210" class="field-text">os_name (String)</text>
  <text x="330" y="225" class="field-text">os_version (String)</text>
  <text x="330" y="240" class="field-text">hostname (String)</text>
  <text x="330" y="255" class="field-text">cpu_count (Integer)</text>
  <text x="330" y="270" class="field-text">cpu_percent (Float)</text>
  <text x="330" y="285" class="field-text">memory_total (BigInteger)</text>
  <text x="330" y="300" class="field-text">memory_used (BigInteger)</text>
  <text x="330" y="315" class="field-text">memory_percent (Float)</text>
  <text x="330" y="330" class="field-text">disk_total (BigInteger)</text>
  <text x="330" y="345" class="field-text">disk_used (BigInteger)</text>
  <text x="330" y="360" class="field-text">disk_percent (Float)</text>
  <text x="330" y="375" class="field-text">uptime (Integer)</text>
  <text x="330" y="390" class="field-text">last_heartbeat (DateTime)</text>
  <text x="330" y="405" class="field-text">client_certificate (Text)</text>
  <text x="330" y="420" class="field-text">certificate_fingerprint (String)</text>
  <text x="330" y="435" class="field-text">approved_at (DateTime)</text>
  <text x="330" y="450" class="field-text">approved_by (String)</text>
  <text x="330" y="465" class="field-text">rejected_at (DateTime)</text>
  <text x="330" y="480" class="field-text">rejected_by (String)</text>
  <text x="330" y="495" class="field-text">created_at (DateTime)</text>
  <text x="330" y="510" class="field-text">updated_at (DateTime)</text>
  <text x="330" y="525" class="field-text fk-field">🔗 owner_id (UUID → User.id)</text>

  <!-- Tag Table -->
  <rect x="680" y="110" width="200" height="180" class="table-box core-table"/>
  <text x="780" y="130" text-anchor="middle" class="table-title">Tag</text>
  <text x="690" y="150" class="field-text uuid-field">🔑 id (UUID)</text>
  <text x="690" y="165" class="field-text">name (String, Unique)</text>
  <text x="690" y="180" class="field-text">color (String)</text>
  <text x="690" y="195" class="field-text">description (Text)</text>
  <text x="690" y="210" class="field-text">created_at (DateTime)</text>
  <text x="690" y="225" class="field-text">updated_at (DateTime)</text>
  <text x="690" y="240" class="field-text fk-field">🔗 created_by (UUID → User.id)</text>

  <!-- Hardware Group -->
  <text x="50" y="460" class="table-title" font-size="16">Hardware &amp; System Information</text>

  <!-- Network Interface Table -->
  <rect x="50" y="470" width="220" height="200" class="table-box hardware-table"/>
  <text x="160" y="490" text-anchor="middle" class="table-title">NetworkInterface</text>
  <text x="60" y="510" class="field-text uuid-field">🔑 id (UUID)</text>
  <text x="60" y="525" class="field-text">interface_name (String)</text>
  <text x="60" y="540" class="field-text">ip_address (String)</text>
  <text x="60" y="555" class="field-text">mac_address (String)</text>
  <text x="60" y="570" class="field-text">is_up (Boolean)</text>
  <text x="60" y="585" class="field-text">bytes_sent (BigInteger)</text>
  <text x="60" y="600" class="field-text">bytes_recv (BigInteger)</text>
  <text x="60" y="615" class="field-text">created_at (DateTime)</text>
  <text x="60" y="630" class="field-text">updated_at (DateTime)</text>
  <text x="60" y="645" class="field-text fk-field">🔗 host_id (UUID → Host.id)</text>

  <!-- Mount Point Table -->
  <rect x="320" y="650" width="220" height="180" class="table-box hardware-table"/>
  <text x="430" y="670" text-anchor="middle" class="table-title">MountPoint</text>
  <text x="330" y="690" class="field-text uuid-field">🔑 id (UUID)</text>
  <text x="330" y="705" class="field-text">device (String)</text>
  <text x="330" y="720" class="field-text">mountpoint (String)</text>
  <text x="330" y="735" class="field-text">fstype (String)</text>
  <text x="330" y="750" class="field-text">size_total (BigInteger)</text>
  <text x="330" y="765" class="field-text">size_used (BigInteger)</text>
  <text x="330" y="780" class="field-text">size_free (BigInteger)</text>
  <text x="330" y="795" class="field-text">created_at (DateTime)</text>
  <text x="330" y="810" class="field-text fk-field">🔗 host_id (UUID → Host.id)</text>

  <!-- Software Group -->
  <text x="680" y="330" class="table-title" font-size="16">Software Management</text>

  <!-- Package Update Table -->
  <rect x="680" y="340" width="240" height="260" class="table-box software-table"/>
  <text x="800" y="360" text-anchor="middle" class="table-title">PackageUpdate</text>
  <text x="690" y="380" class="field-text uuid-field">🔑 id (UUID)</text>
  <text x="690" y="395" class="field-text">package_name (String)</text>
  <text x="690" y="410" class="field-text">current_version (String)</text>
  <text x="690" y="425" class="field-text">available_version (String)</text>
  <text x="690" y="440" class="field-text">update_type (String)</text>
  <text x="690" y="455" class="field-text">package_manager (String)</text>
  <text x="690" y="470" class="field-text">description (Text)</text>
  <text x="690" y="485" class="field-text">requires_reboot (Boolean)</text>
  <text x="690" y="500" class="field-text">size_mb (Float)</text>
  <text x="690" y="515" class="field-text">security_update (Boolean)</text>
  <text x="690" y="530" class="field-text">discovered_at (DateTime)</text>
  <text x="690" y="545" class="field-text">created_at (DateTime)</text>
  <text x="690" y="560" class="field-text">updated_at (DateTime)</text>
  <text x="690" y="575" class="field-text fk-field">🔗 host_id (UUID → Host.id)</text>

  <!-- Package Installation Request Table -->
  <rect x="980" y="340" width="260" height="300" class="table-box software-table"/>
  <text x="1110" y="360" text-anchor="middle" class="table-title">PackageInstallationRequest</text>
  <text x="990" y="380" class="field-text uuid-field">🔑 id (UUID)</text>
  <text x="990" y="395" class="field-text">status (String)</text>
  <text x="990" y="410" class="field-text">operation_type (String)</text>
  <text x="990" y="425" class="field-text">requested_by (String)</text>
  <text x="990" y="440" class="field-text">requested_at (DateTime)</text>
  <text x="990" y="455" class="field-text">started_at (DateTime)</text>
  <text x="990" y="470" class="field-text">completed_at (DateTime)</text>
  <text x="990" y="485" class="field-text">result_log (Text)</text>
  <text x="990" y="500" class="field-text">progress_percentage (Integer)</text>
  <text x="990" y="515" class="field-text">current_step (String)</text>
  <text x="990" y="530" class="field-text">estimated_time_remaining (Integer)</text>
  <text x="990" y="545" class="field-text">packages_total (Integer)</text>
  <text x="990" y="560" class="field-text">packages_completed (Integer)</text>
  <text x="990" y="575" class="field-text">packages_failed (Integer)</text>
  <text x="990" y="590" class="field-text">created_at (DateTime)</text>
  <text x="990" y="605" class="field-text">updated_at (DateTime)</text>
  <text x="990" y="620" class="field-text fk-field">🔗 host_id (UUID → Host.id)</text>

  <!-- Available Package Table -->
  <rect x="980" y="680" width="220" height="200" class="table-box software-table"/>
  <text x="1090" y="700" text-anchor="middle" class="table-title">AvailablePackage</text>
  <text x="990" y="720" class="field-text uuid-field">🔑 id (UUID)</text>
  <text x="990" y="735" class="field-text">package_name (String)</text>
  <text x="990" y="750" class="field-text">version (String)</text>
  <text x="990" y="765" class="field-text">description (Text)</text>
  <text x="990" y="780" class="field-text">package_manager (String)</text>
  <text x="990" y="795" class="field-text">size_mb (Float)</text>
  <text x="990" y="810" class="field-text">last_updated (DateTime)</text>
  <text x="990" y="825" class="field-text">created_at (DateTime)</text>
  <text x="990" y="840" class="field-text fk-field">🔗 host_id (UUID → Host.id)</text>

  <!-- Messaging Group -->
  <text x="1300" y="110" class="table-title" font-size="16">Real-time Messaging</text>

  <!-- Message Queue Table -->
  <rect x="1300" y="120" width="220" height="280" class="table-box message-table"/>
  <text x="1410" y="140" text-anchor="middle" class="table-title">MessageQueue</text>
  <text x="1310" y="160" class="field-text uuid-field">🔑 id (UUID)</text>
  <text x="1310" y="175" class="field-text">message_type (String)</text>
  <text x="1310" y="190" class="field-text">direction (String)</text>
  <text x="1310" y="205" class="field-text">content (Text)</text>
  <text x="1310" y="220" class="field-text">status (String)</text>
  <text x="1310" y="235" class="field-text">priority (Integer)</text>
  <text x="1310" y="250" class="field-text">retry_count (Integer)</text>
  <text x="1310" y="265" class="field-text">max_retries (Integer)</text>
  <text x="1310" y="280" class="field-text">scheduled_for (DateTime)</text>
  <text x="1310" y="295" class="field-text">processed_at (DateTime)</text>
  <text x="1310" y="310" class="field-text">error_message (Text)</text>
  <text x="1310" y="325" class="field-text">created_at (DateTime)</text>
  <text x="1310" y="340" class="field-text">updated_at (DateTime)</text>
  <text x="1310" y="355" class="field-text fk-field">🔗 host_id (UUID → Host.id)</text>

  <!-- Heartbeat Table -->
  <rect x="1300" y="430" width="220" height="200" class="table-box message-table"/>
  <text x="1410" y="450" text-anchor="middle" class="table-title">Heartbeat</text>
  <text x="1310" y="470" class="field-text uuid-field">🔑 id (UUID)</text>
  <text x="1310" y="485" class="field-text">timestamp (DateTime)</text>
  <text x="1310" y="500" class="field-text">status (String)</text>
  <text x="1310" y="515" class="field-text">response_time_ms (Integer)</text>
  <text x="1310" y="530" class="field-text">agent_version (String)</text>
  <text x="1310" y="545" class="field-text">system_load (Float)</text>
  <text x="1310" y="560" class="field-text">memory_usage_percent (Float)</text>
  <text x="1310" y="575" class="field-text">disk_usage_percent (Float)</text>
  <text x="1310" y="590" class="field-text">created_at (DateTime)</text>
  <text x="1310" y="605" class="field-text fk-field">🔗 host_id (UUID → Host.id)</text>

  <!-- Relationship Lines -->
  <!-- User to Host (owner) -->
  <path d="M 250 300 L 320 300" class="relationship-line"/>
  <text x="285" y="295" class="relationship-label">1:N</text>

  <!-- User to Tag (created_by) -->
  <path d="M 250 180 L 680 180" class="relationship-line"/>
  <text x="465" y="175" class="relationship-label">1:N</text>

  <!-- Host to NetworkInterface -->
  <path d="M 320 400 L 270 470" class="relationship-line"/>
  <text x="285" y="435" class="relationship-label">1:N</text>

  <!-- Host to MountPoint -->
  <path d="M 460 590 L 460 650" class="relationship-line"/>
  <text x="465" y="620" class="relationship-label">1:N</text>

  <!-- Host to PackageUpdate -->
  <path d="M 600 400 L 680 400" class="relationship-line"/>
  <text x="640" y="395" class="relationship-label">1:N</text>

  <!-- Host to PackageInstallationRequest -->
  <path d="M 600 300 L 980 450" class="relationship-line"/>
  <text x="790" y="370" class="relationship-label">1:N</text>

  <!-- Host to AvailablePackage -->
  <path d="M 600 500 L 980 750" class="relationship-line"/>
  <text x="790" y="620" class="relationship-label">1:N</text>

  <!-- Host to MessageQueue -->
  <path d="M 600 250 L 1300 250" class="relationship-line"/>
  <text x="950" y="245" class="relationship-label">1:N</text>

  <!-- Host to Heartbeat -->
  <path d="M 600 350 L 1300 520" class="relationship-line"/>
  <text x="950" y="430" class="relationship-label">1:N</text>

  <!-- Many-to-Many: Host ↔ Tag (through host_tags junction table) -->
  <path d="M 600 200 L 680 200" class="relationship-line" stroke-dasharray="5,5"/>
  <text x="640" y="195" class="relationship-label">M:N</text>

  <!-- Legend - Positioned in bottom right, clear of all tables -->
  <rect x="50" y="950" width="400" height="200" fill="#f8f9fa" stroke="#ddd" stroke-width="1"/>
  <text x="250" y="975" text-anchor="middle" class="table-title" font-size="16">Legend</text>

  <!-- UUID Security Highlight -->
  <text x="60" y="1000" class="field-text uuid-field">🔐 id (UUID) - Primary Key (UUID v4)</text>
  <text x="60" y="1015" class="field-text fk-field">🔗 Foreign Key (UUID)</text>
  <text x="60" y="1030" class="field-text">📋 Unique Constraint</text>

  <!-- Table Type Legend -->
  <rect x="60" y="1045" width="20" height="15" class="core-table"/>
  <text x="90" y="1057" class="field-text">Core Entity</text>

  <rect x="60" y="1065" width="20" height="15" class="hardware-table"/>
  <text x="90" y="1077" class="field-text">Hardware</text>

  <rect x="60" y="1085" width="20" height="15" class="software-table"/>
  <text x="90" y="1097" class="field-text">Software</text>

  <rect x="250" y="1045" width="20" height="15" class="message-table"/>
  <text x="280" y="1057" class="field-text">Messaging</text>

  <rect x="250" y="1065" width="20" height="15" class="auth-table"/>
  <text x="280" y="1077" class="field-text">Authentication</text>

  <!-- Relationship Legend -->
  <line x1="60" y1="1110" x2="100" y2="1110" class="relationship-line"/>
  <text x="110" y="1115" class="field-text">One-to-Many</text>

  <line x1="60" y1="1125" x2="100" y2="1125" class="relationship-line" stroke-dasharray="5,5"/>
  <text x="110" y="1130" class="field-text">Many-to-Many</text>

  <!-- Security Notice -->
  <rect x="480" y="950" width="450" height="200" class="security-note"/>
  <text x="705" y="975" text-anchor="middle" class="table-title" font-size="16">🔐 UUID Security Benefits</text>
  <text x="490" y="1000" class="field-text" fill="#155724">• Prevents ID enumeration attacks</text>
  <text x="490" y="1015" class="field-text" fill="#155724">• Eliminates predictable resource URLs</text>
  <text x="490" y="1030" class="field-text" fill="#155724">• Prevents replay attacks</text>
  <text x="490" y="1045" class="field-text" fill="#155724">• Enhanced privacy protection</text>
  <text x="490" y="1060" class="field-text" fill="#155724">• GDPR compliance support</text>
  <text x="490" y="1075" class="field-text" fill="#155724">• Non-correlatable identifiers</text>
  <text x="490" y="1095" class="field-text" fill="#155724" font-weight="bold">Migration: BigInteger → UUID (v4)</text>
  <text x="490" y="1110" class="field-text" fill="#155724">All tables migrated to UUID primary keys</text>
  <text x="490" y="1125" class="field-text" fill="#155724">for enhanced security posture</text>

  <!-- Version and Date -->
  <text x="1700" y="1380" text-anchor="end" class="field-text" font-size="10" fill="#999">Updated: 2024-09-22 | UUID Migration Complete</text>
</svg>