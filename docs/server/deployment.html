<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deployment Guide - SysManage Server</title>
    <meta name="description" content="Production deployment strategies and best practices for scalable SysManage infrastructure.">
    <link rel="stylesheet" href="../../assets/css/style.css">
    <link rel="icon" type="image/svg+xml" href="../../assets/images/favicon.svg">
</head>
<body>
    <header class="site-header">
        <nav class="navbar">
            <div class="container">
                <div class="nav-brand">
                    <a href="../../">
                        <img src="../../assets/images/sysmanage-logo.svg" alt="SysManage" class="logo">
                    </a>
                </div>
                <div class="nav-menu">
                    <a href="../../#features" class="nav-link">Features</a>
                    <a href="../../#getting-started" class="nav-link">Getting Started</a>
                    <a href="../" class="nav-link active">Documentation</a>
                    <a href="https://github.com/bceverly/sysmanage" class="nav-link" target="_blank">GitHub</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="docs-main">
        <div class="container">
            <div class="docs-breadcrumb">
                <a href="../">Documentation</a> > <a href="./">Server</a> > <span>Deployment</span>
            </div>

            <div class="docs-header">
                <h1>Deployment Guide</h1>
                <p>Production deployment strategies and best practices for scalable, secure, and reliable SysManage infrastructure.</p>
            </div>

            <div class="docs-content">
                <section class="docs-overview">
                    <h2>Deployment Overview</h2>
                    <p>SysManage can be deployed in various configurations depending on your infrastructure requirements, from single-server setups to highly available multi-node clusters.</p>

                    <div class="deployment-strategies">
                        <div class="strategy-card">
                            <h3>üñ•Ô∏è Single Server Deployment</h3>
                            <p>Ideal for small to medium environments (up to 100 hosts)</p>
                            <ul>
                                <li>Single server hosts all components</li>
                                <li>PostgreSQL database on same server</li>
                                <li>Simple configuration and maintenance</li>
                                <li>Lower resource requirements</li>
                            </ul>
                        </div>
                        <div class="strategy-card">
                            <h3>üîÑ High Availability Deployment</h3>
                            <p>Production environments requiring zero downtime</p>
                            <ul>
                                <li>Multiple application servers</li>
                                <li>Load balancer with SSL termination</li>
                                <li>Database clustering with failover</li>
                                <li>Redundant network and storage</li>
                            </ul>
                        </div>
                        <div class="strategy-card">
                            <h3>‚òÅÔ∏è Cloud Deployment</h3>
                            <p>Scalable cloud-native deployment options</p>
                            <ul>
                                <li>Container orchestration (Kubernetes)</li>
                                <li>Auto-scaling capabilities</li>
                                <li>Managed database services</li>
                                <li>Multi-region availability</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section class="docs-section">
                    <h2>Production Checklist</h2>

                    <div class="checklist-section">
                        <h3>Pre-Deployment</h3>
                        <div class="checklist">
                            <label><input type="checkbox"> Server hardware/VM specifications meet requirements</label>
                            <label><input type="checkbox"> Network connectivity and firewall rules configured</label>
                            <label><input type="checkbox"> SSL certificates obtained and validated</label>
                            <label><input type="checkbox"> DNS records configured</label>
                            <label><input type="checkbox"> PostgreSQL database server prepared</label>
                            <label><input type="checkbox"> Backup and monitoring systems in place</label>
                        </div>
                    </div>

                    <div class="checklist-section">
                        <h3>Security Configuration</h3>
                        <div class="checklist">
                            <label><input type="checkbox"> HTTPS/TLS enabled and enforced</label>
                            <label><input type="checkbox"> Strong password policies configured</label>
                            <label><input type="checkbox"> JWT token settings optimized</label>
                            <label><input type="checkbox"> Database access restricted to application</label>
                            <label><input type="checkbox"> Firewall rules limiting access to required ports</label>
                            <label><input type="checkbox"> Log file permissions and rotation configured</label>
                        </div>
                    </div>

                    <div class="checklist-section">
                        <h3>Performance Optimization</h3>
                        <div class="checklist">
                            <label><input type="checkbox"> Database connection pooling configured</label>
                            <label><input type="checkbox"> Frontend assets minified and compressed</label>
                            <label><input type="checkbox"> Caching headers configured</label>
                            <label><input type="checkbox"> Resource limits set for application processes</label>
                            <label><input type="checkbox"> Log levels set appropriately for production</label>
                        </div>
                    </div>
                </section>

                <section class="docs-section">
                    <h2>Single Server Deployment</h2>

                    <h3>System Requirements</h3>
                    <div class="requirements-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Component</th>
                                    <th>Minimum</th>
                                    <th>Recommended</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>CPU</td>
                                    <td>2 cores</td>
                                    <td>4+ cores</td>
                                </tr>
                                <tr>
                                    <td>RAM</td>
                                    <td>4 GB</td>
                                    <td>8+ GB</td>
                                </tr>
                                <tr>
                                    <td>Storage</td>
                                    <td>20 GB SSD</td>
                                    <td>50+ GB SSD</td>
                                </tr>
                                <tr>
                                    <td>Network</td>
                                    <td>100 Mbps</td>
                                    <td>1 Gbps</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>Installation Steps</h3>
                    <div class="code-block">
                        <pre><code># 1. Update system packages
sudo apt update && sudo apt upgrade -y

# 2. Install dependencies
sudo apt install -y python3.12 python3.12-venv python3-pip postgresql postgresql-contrib nginx

# 3. Create application user
sudo useradd -m -s /bin/bash sysmanage

# 4. Clone repository
sudo -u sysmanage git clone https://github.com/bceverly/sysmanage.git /home/sysmanage/sysmanage

# 5. Setup Python environment
cd /home/sysmanage/sysmanage
sudo -u sysmanage python3.12 -m venv .venv
sudo -u sysmanage .venv/bin/pip install -r requirements.txt

# 6. Install Node.js and frontend dependencies
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt install -y nodejs
cd frontend && sudo -u sysmanage npm install && sudo -u sysmanage npm run build

# 7. Configure PostgreSQL
sudo -u postgres createuser -P sysmanage
sudo -u postgres createdb -O sysmanage sysmanage</code></pre>
                    </div>

                    <h3>Production Configuration</h3>
                    <div class="code-block">
                        <pre><code># /etc/sysmanage.yaml
database:
  host: localhost
  port: 5432
  name: sysmanage
  user: sysmanage
  password: "your_secure_password"

webui:
  host: 0.0.0.0
  port: 6443
  https: true
  ssl_cert: "/etc/ssl/certs/sysmanage.crt"
  ssl_key: "/etc/ssl/private/sysmanage.key"

authentication:
  jwt_secret: "your_jwt_secret_key_here"
  token_expire_minutes: 60

logging:
  level: INFO
  file: "/var/log/sysmanage/sysmanage.log"</code></pre>
                    </div>
                </section>

                <section class="docs-section">
                    <h2>High Availability Deployment</h2>

                    <h3>Architecture Overview</h3>
                    <div class="architecture-diagram">
                        <pre>
    [Load Balancer (HAProxy/Nginx)]
                    |
         +----------+----------+
         |                     |
    [App Server 1]        [App Server 2]
         |                     |
         +----------+----------+
                    |
            [PostgreSQL Cluster]
            (Primary + Standby)
        </pre>
                    </div>

                    <h3>Load Balancer Configuration</h3>
                    <div class="code-block">
                        <h4>Nginx Configuration</h4>
                        <pre><code># /etc/nginx/sites-available/sysmanage
upstream sysmanage_backend {
    least_conn;
    server 10.0.1.10:6443 max_fails=3 fail_timeout=30s;
    server 10.0.1.11:6443 max_fails=3 fail_timeout=30s;
}

server {
    listen 443 ssl http2;
    server_name sysmanage.yourdomain.com;

    ssl_certificate /etc/ssl/certs/sysmanage.crt;
    ssl_certificate_key /etc/ssl/private/sysmanage.key;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512;

    location / {
        proxy_pass https://sysmanage_backend;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket support
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }

    # Health check endpoint
    location /health {
        proxy_pass https://sysmanage_backend/health;
        access_log off;
    }
}</code></pre>
                    </div>

                    <h3>Database Clustering</h3>
                    <div class="code-block">
                        <h4>PostgreSQL Streaming Replication</h4>
                        <pre><code># Primary server postgresql.conf
listen_addresses = '*'
wal_level = replica
max_wal_senders = 3
max_replication_slots = 3
synchronous_commit = on
synchronous_standby_names = 'standby1'

# Standby server recovery.conf
standby_mode = 'on'
primary_conninfo = 'host=primary_ip port=5432 user=replicator'
recovery_target_timeline = 'latest'</code></pre>
                    </div>
                </section>

                <section class="docs-section">
                    <h2>Container Deployment</h2>

                    <h3>Docker Compose</h3>
                    <div class="code-block">
                        <pre><code># docker-compose.yml
version: '3.8'

services:
  sysmanage:
    build: .
    ports:
      - "6443:6443"
    environment:
      - DATABASE_URL=postgresql://sysmanage:password@db:5432/sysmanage
      - JWT_SECRET=your_jwt_secret
    depends_on:
      - db
    volumes:
      - ./config:/etc/sysmanage
      - logs:/var/log/sysmanage

  db:
    image: postgres:15
    environment:
      - POSTGRES_DB=sysmanage
      - POSTGRES_USER=sysmanage
      - POSTGRES_PASSWORD=password
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./ssl:/etc/ssl/certs
    depends_on:
      - sysmanage

volumes:
  postgres_data:
  logs:</code></pre>
                    </div>

                    <h3>Kubernetes Deployment</h3>
                    <div class="code-block">
                        <pre><code># k8s/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sysmanage
  labels:
    app: sysmanage
spec:
  replicas: 3
  selector:
    matchLabels:
      app: sysmanage
  template:
    metadata:
      labels:
        app: sysmanage
    spec:
      containers:
      - name: sysmanage
        image: sysmanage:latest
        ports:
        - containerPort: 6443
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: sysmanage-secrets
              key: database-url
        resources:
          requests:
            memory: "512Mi"
            cpu: "250m"
          limits:
            memory: "1Gi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /health
            port: 6443
            scheme: HTTPS
          initialDelaySeconds: 30
          periodSeconds: 30</code></pre>
                    </div>
                </section>

                <section class="docs-section">
                    <h2>Monitoring & Logging</h2>

                    <h3>System Monitoring</h3>
                    <div class="monitoring-setup">
                        <h4>Prometheus Configuration</h4>
                        <div class="code-block">
                            <pre><code># prometheus.yml
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'sysmanage'
    static_configs:
      - targets: ['localhost:6443']
    metrics_path: /metrics
    scheme: https</code></pre>
                        </div>

                        <h4>Health Check Endpoint</h4>
                        <div class="code-block">
                            <pre><code># Built-in health check
curl -k https://localhost:6443/health

# Response
{
  "status": "healthy",
  "database": "connected",
  "version": "1.0.0",
  "uptime": "72h15m30s"
}</code></pre>
                        </div>
                    </div>

                    <h3>Log Management</h3>
                    <div class="code-block">
                        <pre><code># Logrotate configuration (/etc/logrotate.d/sysmanage)
/var/log/sysmanage/*.log {
    daily
    missingok
    rotate 30
    compress
    delaycompress
    notifempty
    create 644 sysmanage sysmanage
    postrotate
        systemctl reload sysmanage
    endscript
}

# Centralized logging with rsyslog
# /etc/rsyslog.d/sysmanage.conf
:programname, isequal, "sysmanage" /var/log/sysmanage/sysmanage.log
& stop</code></pre>
                    </div>
                </section>

                <section class="docs-section">
                    <h2>Backup & Disaster Recovery</h2>

                    <h3>Database Backup</h3>
                    <div class="code-block">
                        <pre><code># Automated backup script
#!/bin/bash
# /usr/local/bin/backup_sysmanage.sh

BACKUP_DIR="/backup/sysmanage"
DATE=$(date +%Y%m%d_%H%M%S)
DB_NAME="sysmanage"

# Create backup directory
mkdir -p $BACKUP_DIR

# Database backup
pg_dump -h localhost -U sysmanage $DB_NAME | gzip > $BACKUP_DIR/db_backup_$DATE.sql.gz

# Configuration backup
tar -czf $BACKUP_DIR/config_backup_$DATE.tar.gz /etc/sysmanage/

# Keep only last 30 days
find $BACKUP_DIR -name "*.gz" -mtime +30 -delete

# Cron entry: 0 2 * * * /usr/local/bin/backup_sysmanage.sh</code></pre>
                    </div>

                    <h3>Disaster Recovery Plan</h3>
                    <ol>
                        <li><strong>Assessment:</strong> Determine scope of failure and affected systems</li>
                        <li><strong>Communication:</strong> Notify stakeholders and users of the incident</li>
                        <li><strong>Isolation:</strong> Isolate failed components to prevent further damage</li>
                        <li><strong>Recovery:</strong> Restore from backups or failover to standby systems</li>
                        <li><strong>Verification:</strong> Test restored systems and verify functionality</li>
                        <li><strong>Post-mortem:</strong> Document incident and improve procedures</li>
                    </ol>
                </section>

                <section class="docs-section">
                    <h2>Performance Optimization</h2>

                    <h3>Database Tuning</h3>
                    <div class="code-block">
                        <pre><code># PostgreSQL optimization settings
# postgresql.conf

# Memory settings
shared_buffers = 256MB                  # 25% of RAM
effective_cache_size = 1GB              # 75% of RAM
work_mem = 4MB
maintenance_work_mem = 64MB

# Checkpoint settings
checkpoint_completion_target = 0.9
wal_buffers = 16MB
default_statistics_target = 100

# Connection settings
max_connections = 200

# Query optimization
random_page_cost = 1.1                  # For SSD storage
effective_io_concurrency = 200          # For SSD storage</code></pre>
                    </div>

                    <h3>Application Tuning</h3>
                    <div class="code-block">
                        <pre><code># Uvicorn production settings
uvicorn backend.main:app \
  --host 0.0.0.0 \
  --port 6443 \
  --workers 4 \
  --worker-class uvicorn.workers.UvicornWorker \
  --ssl-keyfile /etc/ssl/private/sysmanage.key \
  --ssl-certfile /etc/ssl/certs/sysmanage.crt \
  --access-log \
  --log-level info</code></pre>
                    </div>

                    <h3>Caching Strategy</h3>
                    <ul>
                        <li><strong>Redis:</strong> Session storage and temporary data caching</li>
                        <li><strong>CDN:</strong> Static asset delivery and geographic distribution</li>
                        <li><strong>Application Cache:</strong> Database query result caching</li>
                        <li><strong>Browser Cache:</strong> Client-side asset caching with appropriate headers</li>
                    </ul>
                </section>

                <section class="docs-section">
                    <h2>Security Hardening</h2>

                    <h3>Network Security</h3>
                    <div class="code-block">
                        <pre><code># Firewall rules (ufw example)
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow ssh
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw allow from 10.0.1.0/24 to any port 5432  # Database access
sudo ufw enable

# Fail2ban configuration
# /etc/fail2ban/jail.local
[sysmanage]
enabled = true
port = 443
filter = sysmanage
logpath = /var/log/sysmanage/access.log
maxretry = 3
bantime = 3600</code></pre>
                    </div>

                    <h3>Application Security</h3>
                    <ul>
                        <li><strong>HTTPS Only:</strong> Enforce TLS for all connections</li>
                        <li><strong>HSTS:</strong> HTTP Strict Transport Security headers</li>
                        <li><strong>CSP:</strong> Content Security Policy implementation</li>
                        <li><strong>Rate Limiting:</strong> API endpoint rate limiting</li>
                        <li><strong>Input Validation:</strong> Comprehensive input sanitization</li>
                        <li><strong>Audit Logging:</strong> Log all administrative actions</li>
                    </ul>
                </section>

                <section class="docs-section">
                    <h2>Maintenance & Updates</h2>

                    <h3>Update Procedure</h3>
                    <ol>
                        <li><strong>Backup:</strong> Create full system backup before updates</li>
                        <li><strong>Testing:</strong> Test updates in staging environment</li>
                        <li><strong>Maintenance Window:</strong> Schedule maintenance with user notification</li>
                        <li><strong>Update:</strong> Apply updates following documented procedures</li>
                        <li><strong>Verification:</strong> Verify all systems function correctly</li>
                        <li><strong>Rollback Plan:</strong> Have rollback procedures ready if needed</li>
                    </ol>

                    <h3>Maintenance Tasks</h3>
                    <div class="maintenance-schedule">
                        <h4>Daily</h4>
                        <ul>
                            <li>Monitor system health and performance</li>
                            <li>Review application logs for errors</li>
                            <li>Verify backup completion</li>
                        </ul>

                        <h4>Weekly</h4>
                        <ul>
                            <li>Review security logs and alerts</li>
                            <li>Update system packages</li>
                            <li>Test backup restoration procedures</li>
                        </ul>

                        <h4>Monthly</h4>
                        <ul>
                            <li>Security vulnerability assessment</li>
                            <li>Performance analysis and optimization</li>
                            <li>Capacity planning review</li>
                        </ul>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; 2024 SysManage. Licensed under AGPLv3.</p>
        </div>
    </footer>
</body>
</html>