<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Communication Protocols - SysManage Architecture</title>
    <meta name="description" content="Comprehensive guide to SysManage's communication protocols including WebSocket, REST API, and real-time data synchronization mechanisms.">
    <link rel="stylesheet" href="../../assets/css/style.css">
    <link rel="icon" type="image/svg+xml" href="../../assets/images/favicon.svg">
    <style>
        .protocol-banner {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            padding: 2rem;
            border-radius: 12px;
            margin: 2rem 0;
            text-align: center;
        }

        .protocol-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .protocol-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }

        .protocol-title {
            display: block;
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .protocol-description {
            font-size: 0.9rem;
            opacity: 0.9;
            line-height: 1.5;
        }

        .communication-layer {
            background: #f8f9fa;
            border-left: 4px solid #27ae60;
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .layer-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: #27ae60;
            margin-bottom: 0.5rem;
        }

        .message-flow {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 2rem;
            border-radius: 12px;
            margin: 2rem 0;
        }

        .flow-sequence {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 1rem;
        }

        .flow-step {
            display: flex;
            align-items: center;
            background: white;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .step-number {
            background: #27ae60;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            font-weight: bold;
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-weight: bold;
            margin-bottom: 0.3rem;
        }

        .step-description {
            font-size: 0.9rem;
            color: #666;
        }

        .protocol-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .feature-card {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            border-top: 3px solid #27ae60;
        }

        .feature-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .feature-title {
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: #2c3e50;
        }

        .security-features {
            background: #2c3e50;
            color: white;
            padding: 2rem;
            border-radius: 12px;
            margin: 2rem 0;
        }

        .security-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .security-item {
            background: rgba(39, 174, 96, 0.2);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid rgba(39, 174, 96, 0.3);
            text-align: center;
        }

        .security-icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .code-example {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 1.5rem;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.4;
            overflow-x: auto;
            margin: 1rem 0;
        }

        .code-title {
            color: #27ae60;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .performance-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .metric-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .protocol-grid {
                grid-template-columns: 1fr;
            }

            .flow-step {
                flex-direction: column;
                text-align: center;
            }

            .step-number {
                margin-right: 0;
                margin-bottom: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <header class="site-header">
        <nav class="navbar">
            <div class="container">
                <div class="nav-brand">
                    <a href="../../">
                        <img src="../../assets/images/sysmanage-logo.svg" alt="SysManage" class="logo">
                    </a>
                </div>
                <div class="nav-menu">
                    <a href="../../#features" class="nav-link">Features</a>
                    <a href="../../#getting-started" class="nav-link">Getting Started</a>
                    <a href="../" class="nav-link active">Documentation</a>
                    <a href="https://github.com/bceverly/sysmanage" class="nav-link" target="_blank">GitHub</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="docs-main">
        <div class="container">
            <nav class="breadcrumb">
                <a href="../">Documentation</a> &gt;
                <a href="./">Architecture</a> &gt;
                <span>Communication Protocols</span>
            </nav>

            <div class="protocol-banner">
                <h1>üîó Communication Protocols</h1>
                <p>Advanced communication infrastructure enabling secure, real-time, and reliable data exchange</p>

                <div class="protocol-grid">
                    <div class="protocol-card">
                        <span class="protocol-title">üåê WebSocket Real-time</span>
                        <div class="protocol-description">
                            Bidirectional real-time communication with persistent connections, automatic reconnection, and message queuing
                        </div>
                    </div>
                    <div class="protocol-card">
                        <span class="protocol-title">üöÄ REST API</span>
                        <div class="protocol-description">
                            High-performance RESTful endpoints with OpenAPI documentation, request validation, and comprehensive error handling
                        </div>
                    </div>
                    <div class="protocol-card">
                        <span class="protocol-title">üîê mTLS Security</span>
                        <div class="protocol-description">
                            Mutual TLS encryption with X.509 certificates ensuring end-to-end security and client authentication
                        </div>
                    </div>
                    <div class="protocol-card">
                        <span class="protocol-title">üì° Message Queuing</span>
                        <div class="protocol-description">
                            Persistent message queuing with automatic retry logic, delivery guarantees, and connection health monitoring
                        </div>
                    </div>
                </div>
            </div>

            <section>
                <h2>üèóÔ∏è Protocol Architecture</h2>
                <p>SysManage implements a multi-layer communication architecture designed for reliability, security, and performance.</p>

                <div class="communication-layer">
                    <div class="layer-title">üîê Security Layer (TLS 1.3)</div>
                    <p><strong>Mutual TLS Encryption:</strong> All communications are secured using TLS 1.3 with mutual authentication. Both server and agents present X.509 certificates for verification, ensuring secure identity verification and encrypted data transmission.</p>
                </div>

                <div class="communication-layer">
                    <div class="layer-title">üåê Application Layer (WebSocket/HTTP)</div>
                    <p><strong>Dual Protocol Support:</strong> WebSocket connections for real-time bidirectional communication and HTTP/REST for request-response operations. WebSocket provides persistent connections for immediate command execution and status updates.</p>
                </div>

                <div class="communication-layer">
                    <div class="layer-title">üì® Message Layer (JSON)</div>
                    <p><strong>Structured Messaging:</strong> JSON-based message format with typed schemas, message IDs, timestamps, and operation metadata. Supports command messages, response messages, status updates, and error notifications.</p>
                </div>

                <div class="communication-layer">
                    <div class="layer-title">üîÑ Reliability Layer</div>
                    <p><strong>Delivery Guarantees:</strong> Persistent message queuing with automatic retry logic, exponential backoff, and dead letter queues. Connection health monitoring with automatic reconnection and message persistence during disconnections.</p>
                </div>
            </section>

            <section>
                <h2>üîÑ Message Flow Sequence</h2>
                <div class="message-flow">
                    <h3>Typical Command Execution Flow</h3>
                    <div class="flow-sequence">
                        <div class="flow-step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <div class="step-title">User Initiates Action</div>
                                <div class="step-description">User triggers operation through React frontend interface</div>
                            </div>
                        </div>

                        <div class="flow-step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <div class="step-title">REST API Validation</div>
                                <div class="step-description">FastAPI validates request, authenticates user, and authorizes operation</div>
                            </div>
                        </div>

                        <div class="flow-step">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <div class="step-title">Message Creation</div>
                                <div class="step-description">Server creates structured command message with unique ID and timestamps</div>
                            </div>
                        </div>

                        <div class="flow-step">
                            <div class="step-number">4</div>
                            <div class="step-content">
                                <div class="step-title">WebSocket Transmission</div>
                                <div class="step-description">Message sent to target agent via persistent WebSocket connection</div>
                            </div>
                        </div>

                        <div class="flow-step">
                            <div class="step-number">5</div>
                            <div class="step-content">
                                <div class="step-title">Agent Processing</div>
                                <div class="step-description">Agent receives, validates, and executes command on target system</div>
                            </div>
                        </div>

                        <div class="flow-step">
                            <div class="step-number">6</div>
                            <div class="step-content">
                                <div class="step-title">Result Transmission</div>
                                <div class="step-description">Agent sends execution results and status updates back to server</div>
                            </div>
                        </div>

                        <div class="flow-step">
                            <div class="step-number">7</div>
                            <div class="step-content">
                                <div class="step-title">Real-time UI Update</div>
                                <div class="step-description">Frontend receives live updates via WebSocket and updates user interface</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section>
                <h2>üöÄ Protocol Features</h2>
                <div class="protocol-features">
                    <div class="feature-card">
                        <div class="feature-icon">‚ö°</div>
                        <div class="feature-title">High Performance</div>
                        <p>Optimized for low latency with connection pooling, efficient serialization, and minimal overhead protocols.</p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">üîÑ</div>
                        <div class="feature-title">Auto Reconnection</div>
                        <p>Intelligent reconnection logic with exponential backoff, connection health monitoring, and seamless failover.</p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">üì¶</div>
                        <div class="feature-title">Message Persistence</div>
                        <p>Persistent message queuing ensures delivery even during network interruptions or agent disconnections.</p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">üéØ</div>
                        <div class="feature-title">Targeted Delivery</div>
                        <p>Efficient message routing to specific hosts, host groups, or broadcast scenarios with delivery confirmation.</p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">üìä</div>
                        <div class="feature-title">Real-time Monitoring</div>
                        <p>Live connection status, message delivery tracking, and performance metrics with alerting capabilities.</p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-title">üîç</div>
                        <div class="feature-title">Comprehensive Logging</div>
                        <p>Detailed audit logs for all communications, message tracking, and debugging with retention policies.</p>
                    </div>
                </div>
            </section>

            <section>
                <h2>üîê Security Implementation</h2>
                <div class="security-features">
                    <h3>Multi-Layer Security Architecture</h3>
                    <div class="security-grid">
                        <div class="security-item">
                            <div class="security-icon">üîê</div>
                            <div>mTLS Encryption</div>
                        </div>
                        <div class="security-item">
                            <div class="security-icon">üìú</div>
                            <div>X.509 Certificates</div>
                        </div>
                        <div class="security-item">
                            <div class="security-icon">üîë</div>
                            <div>JWT Authentication</div>
                        </div>
                        <div class="security-item">
                            <div class="security-icon">üõ°Ô∏è</div>
                            <div>Input Validation</div>
                        </div>
                        <div class="security-item">
                            <div class="security-icon">üìä</div>
                            <div>Audit Logging</div>
                        </div>
                        <div class="security-item">
                            <div class="security-icon">‚è±Ô∏è</div>
                            <div>Token Expiration</div>
                        </div>
                    </div>
                </div>
            </section>

            <section>
                <h2>üíª Implementation Examples</h2>

                <h3>WebSocket Message Structure</h3>
                <div class="code-example">
                    <div class="code-title">Command Message Format</div>
{
  "message_id": "uuid-v4",
  "timestamp": "2024-09-20T12:00:00Z",
  "message_type": "command",
  "command_type": "package_operation",
  "target_host": "host-uuid",
  "parameters": {
    "operation": "install",
    "packages": ["nginx", "curl"],
    "options": {"yes": true}
  },
  "expires_at": "2024-09-20T12:30:00Z"
}
                </div>

                <h3>REST API Endpoint</h3>
                <div class="code-example">
                    <div class="code-title">Package Management API</div>
POST /api/hosts/{host_id}/packages/install
Content-Type: application/json
Authorization: Bearer jwt-token

{
  "packages": ["nginx", "curl"],
  "options": {"yes": true},
  "timeout": 300
}
                </div>

                <h3>Agent Response Format</h3>
                <div class="code-example">
                    <div class="code-title">Operation Result</div>
{
  "message_id": "response-uuid",
  "original_message_id": "uuid-v4",
  "timestamp": "2024-09-20T12:05:00Z",
  "message_type": "response",
  "status": "success",
  "result": {
    "installed_packages": ["nginx", "curl"],
    "execution_time": 45.2,
    "output": "Packages installed successfully"
  }
}
                </div>
            </section>

            <section>
                <h2>üìä Performance Metrics</h2>
                <div class="performance-metrics">
                    <div class="metric-card">
                        <div class="metric-value">&lt;5ms</div>
                        <div class="metric-label">Message Latency</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">10,000+</div>
                        <div class="metric-label">Concurrent Connections</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">99.99%</div>
                        <div class="metric-label">Message Delivery Rate</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">30 days</div>
                        <div class="metric-label">Connection Uptime</div>
                    </div>
                </div>
            </section>

            <section>
                <h2>üîó Related Documentation</h2>
                <div class="docs-links">
                    <a href="websocket-protocol.html" class="docs-link">üåê WebSocket Protocol</a>
                    <a href="rest-api-design.html" class="docs-link">üöÄ REST API Design</a>
                    <a href="data-synchronization.html" class="docs-link">üîÑ Data Synchronization</a>
                    <a href="message-flow.html" class="docs-link">üì° Message Flow Diagram</a>
                    <a href="../security/mtls.html" class="docs-link">üîê mTLS Implementation</a>
                    <a href="system-architecture.html" class="docs-link">üèóÔ∏è System Architecture</a>
                </div>
            </section>
        </div>

        <div class="docs-footer">
            <div class="docs-navigation">
                <h3>Quick Navigation</h3>
                <div class="nav-links">
                    <a href="system-architecture.html" class="nav-link">‚Üê System Architecture</a>
                    <a href="websocket-protocol.html" class="nav-link">WebSocket Protocol</a>
                    <a href="rest-api-design.html" class="nav-link">REST API Design</a>
                    <a href="database-design.html" class="nav-link">Database Design ‚Üí</a>
                </div>
            </div>

            <div class="docs-resources">
                <h3>Protocol Resources</h3>
                <div class="resource-links">
                    <a href="message-flow.html" class="resource-link">
                        <span class="resource-icon">üì°</span>
                        <span>Message Flow Diagram</span>
                    </a>
                    <a href="../security/mtls.html" class="resource-link">
                        <span class="resource-icon">üîê</span>
                        <span>mTLS Security Guide</span>
                    </a>
                    <a href="../api/" class="resource-link">
                        <span class="resource-icon">üìö</span>
                        <span>API Reference</span>
                    </a>
                    <a href="data-synchronization.html" class="resource-link">
                        <span class="resource-icon">üîÑ</span>
                        <span>Data Synchronization</span>
                    </a>
                </div>
            </div>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>SysManage</h3>
                    <p>Modern system management platform for comprehensive infrastructure monitoring and automation.</p>
                </div>
                <div class="footer-section">
                    <h3>Documentation</h3>
                    <ul>
                        <li><a href="../server/">Server Docs</a></li>
                        <li><a href="../agent/">Agent Docs</a></li>
                        <li><a href="../api/">API Reference</a></li>
                        <li><a href="../security/">Security</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Community</h3>
                    <ul>
                        <li><a href="https://github.com/bceverly/sysmanage" target="_blank">GitHub Repository</a></li>
                        <li><a href="https://github.com/bceverly/sysmanage/issues" target="_blank">Issue Tracker</a></li>
                        <li><a href="https://github.com/bceverly/sysmanage/issues" target="_blank">Discussions</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>License</h3>
                    <p>Licensed under AGPLv3</p>
                    <p><a href="https://github.com/bceverly/sysmanage/blob/main/LICENSE" target="_blank">View License</a></p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 SysManage. All rights reserved.</p>
            </div>
        </div>
    </footer>
</body>
</html>