<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Best Practices - SysManage Security</title>
    <meta name="description" content="Comprehensive security best practices for SysManage deployments including hardening, compliance frameworks, audit procedures, and incident response.">
    <link rel="stylesheet" href="../../assets/css/style.css">
    <link rel="icon" type="image/svg+xml" href="../../assets/images/favicon.svg">
</head>
<body>
    <header class="site-header">
        <nav class="navbar">
            <div class="container">
                <div class="nav-brand">
                    <a href="../../">
                        <img src="../../assets/images/sysmanage-logo.svg" alt="SysManage" class="logo">
                    </a>
                </div>
                <div class="nav-menu">
                    <a href="../../#features" class="nav-link" data-i18n="nav.features">Features</a>
                    <a href="../../#getting-started" class="nav-link" data-i18n="nav.getting_started">Getting Started</a>
                    <a href="../" class="nav-link active" data-i18n="nav.documentation">Documentation</a>
                    <a href="../../config-builder.html" class="nav-link" data-i18n="nav.config_builder">Configuration Builder</a>
                    <a href="https://github.com/bceverly/sysmanage" class="nav-link" target="_blank" data-i18n="nav.github">GitHub</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="docs-main">
        <div class="container">
            <div class="docs-breadcrumb">
                <a href="../">Documentation</a> > <a href="./">Security</a> > <span>Best Practices</span>
            </div>

            <div class="docs-header">
                <h1>Security Best Practices</h1>
                <p>Comprehensive security recommendations, deployment guidelines, compliance frameworks, and incident response procedures for SysManage environments.</p>
            </div>

            <div class="docs-content">
                <section class="overview">
                    <h2>Security Best Practices Overview</h2>
                    <p>This guide provides enterprise-grade security recommendations for deploying and operating SysManage in production environments. Following these practices ensures robust security posture, regulatory compliance, and operational resilience.</p>

                    <div class="security-pillars">
                        <h3>Security Framework Pillars</h3>
                        <div class="pillars-grid">
                            <div class="pillar-item">
                                <h4>üîê Identity & Access</h4>
                                <p>Strong authentication, authorization, and identity management practices</p>
                            </div>
                            <div class="pillar-item">
                                <h4>üõ°Ô∏è Defense in Depth</h4>
                                <p>Multiple security layers providing comprehensive protection</p>
                            </div>
                            <div class="pillar-item">
                                <h4>üìä Monitoring & Response</h4>
                                <p>Continuous monitoring, threat detection, and incident response</p>
                            </div>
                            <div class="pillar-item">
                                <h4>üîÑ Compliance & Governance</h4>
                                <p>Regulatory compliance and security governance frameworks</p>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="production-deployment">
                    <h2>Production Deployment Security</h2>

                    <h3>Pre-Deployment Security Checklist</h3>
                    <div class="checklist-container">
                        <h4>Infrastructure Security</h4>
                        <ul class="security-checklist">
                            <li>‚úÖ Deploy on hardened operating systems (CIS benchmarks)</li>
                            <li>‚úÖ Configure host-based firewalls with minimal open ports</li>
                            <li>‚úÖ Enable SELinux/AppArmor mandatory access controls</li>
                            <li>‚úÖ Implement fail2ban for intrusion prevention</li>
                            <li>‚úÖ Configure log forwarding to centralized SIEM</li>
                            <li>‚úÖ Enable audit logging at OS and application levels</li>
                            <li>‚úÖ Implement time synchronization (NTP)</li>
                            <li>‚úÖ Configure automated security updates</li>
                        </ul>

                        <h4>Application Security</h4>
                        <ul class="security-checklist">
                            <li>‚úÖ Change all default passwords and secrets</li>
                            <li>‚úÖ Generate strong JWT secret keys</li>
                            <li>‚úÖ Configure TLS certificates from trusted CA</li>
                            <li>‚úÖ Enable database encryption at rest</li>
                            <li>‚úÖ Configure secure session management</li>
                            <li>‚úÖ Enable comprehensive audit logging</li>
                            <li>‚úÖ Set up health monitoring and alerting</li>
                            <li>‚úÖ Configure backup and disaster recovery</li>
                        </ul>

                        <h4>Network Security</h4>
                        <ul class="security-checklist">
                            <li>‚úÖ Implement network segmentation</li>
                            <li>‚úÖ Configure VPN access for administrators</li>
                            <li>‚úÖ Set up intrusion detection/prevention systems</li>
                            <li>‚úÖ Enable DDoS protection</li>
                            <li>‚úÖ Configure load balancer security features</li>
                            <li>‚úÖ Implement API rate limiting and throttling</li>
                            <li>‚úÖ Set up WAF (Web Application Firewall)</li>
                            <li>‚úÖ Configure DNS security (DNSSEC)</li>
                        </ul>
                    </div>

                    <h3>Secure Configuration Templates</h3>
                    <div class="config-templates">
                        <h4>Production Environment Variables</h4>
                        <div class="code-block">
                            <pre><code># Production security configuration
ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=INFO

# Database security
DATABASE_SSL_MODE=require
DATABASE_SSL_CERT=/path/to/client-cert.pem
DATABASE_SSL_KEY=/path/to/client-key.pem
DATABASE_SSL_CA=/path/to/ca-cert.pem
DATABASE_CONNECTION_POOL_SIZE=20
DATABASE_CONNECTION_TIMEOUT=30

# JWT security
JWT_SECRET_KEY=<strong-256-bit-random-key>
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=15
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7
JWT_BLACKLIST_ENABLED=true

# TLS configuration
TLS_VERSION_MIN=1.2
TLS_CERT_PATH=/etc/ssl/certs/sysmanage.crt
TLS_KEY_PATH=/etc/ssl/private/sysmanage.key
TLS_CA_PATH=/etc/ssl/certs/ca-bundle.crt

# Security headers
SECURITY_HEADERS_ENABLED=true
CSRF_PROTECTION_ENABLED=true
CORS_ORIGINS=["https://sysmanage.company.com"]
RATE_LIMITING_ENABLED=true
RATE_LIMIT_PER_MINUTE=100

# Audit and monitoring
AUDIT_LOGGING_ENABLED=true
AUDIT_LOG_LEVEL=INFO
SECURITY_EVENTS_ENABLED=true
PROMETHEUS_METRICS_ENABLED=true
HEALTH_CHECK_ENABLED=true</code></pre>
                        </div>

                        <h4>Nginx Security Configuration</h4>
                        <div class="code-block">
                            <pre><code># /etc/nginx/sites-available/sysmanage
server {
    listen 443 ssl http2;
    server_name sysmanage.company.com;

    # TLS configuration
    ssl_certificate /etc/ssl/certs/sysmanage.crt;
    ssl_certificate_key /etc/ssl/private/sysmanage.key;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512;
    ssl_prefer_server_ciphers off;
    ssl_session_cache shared:SSL:10m;
    ssl_session_timeout 10m;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;
    add_header Referrer-Policy "strict-origin-when-cross-origin" always;
    add_header Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';" always;

    # Rate limiting
    limit_req zone=sysmanage burst=20 nodelay;
    limit_conn addr 10;

    # Proxy configuration
    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    # WebSocket configuration
    location /ws {
        proxy_pass http://127.0.0.1:8000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}</code></pre>
                        </div>
                    </div>
                </section>

                <section class="system-hardening">
                    <h2>System Hardening</h2>

                    <h3>Operating System Hardening</h3>
                    <div class="hardening-categories">
                        <div class="category-item">
                            <h4>üîí Access Controls</h4>
                            <ul>
                                <li>Disable unnecessary user accounts</li>
                                <li>Configure sudo with minimal privileges</li>
                                <li>Implement SSH key-based authentication</li>
                                <li>Disable password authentication for SSH</li>
                                <li>Configure account lockout policies</li>
                                <li>Enable audit logging for privileged operations</li>
                            </ul>
                        </div>

                        <div class="category-item">
                            <h4>üõ°Ô∏è Network Hardening</h4>
                            <ul>
                                <li>Disable unnecessary network services</li>
                                <li>Configure iptables/firewalld rules</li>
                                <li>Enable TCP wrappers (/etc/hosts.allow)</li>
                                <li>Configure fail2ban for intrusion prevention</li>
                                <li>Disable IPv6 if not required</li>
                                <li>Enable SYN flood protection</li>
                            </ul>
                        </div>

                        <div class="category-item">
                            <h4>üìÅ File System Security</h4>
                            <ul>
                                <li>Set proper file permissions (644/755)</li>
                                <li>Configure separate partitions for logs</li>
                                <li>Enable file integrity monitoring</li>
                                <li>Configure disk encryption (LUKS)</li>
                                <li>Implement regular security scans</li>
                                <li>Set up automated malware scanning</li>
                            </ul>
                        </div>

                        <div class="category-item">
                            <h4>üîç Monitoring & Logging</h4>
                            <ul>
                                <li>Configure centralized log collection</li>
                                <li>Enable process accounting (psacct)</li>
                                <li>Set up file access monitoring (auditd)</li>
                                <li>Configure system resource monitoring</li>
                                <li>Implement log rotation and retention</li>
                                <li>Set up security event alerting</li>
                            </ul>
                        </div>
                    </div>

                    <h4>CIS Benchmark Implementation</h4>
                    <div class="code-block">
                        <pre><code># Install and run CIS benchmark scanner
# For Ubuntu/Debian
wget https://workbench.cisecurity.org/files/cis-cat-lite.zip
unzip cis-cat-lite.zip
cd cis-cat-lite
sudo ./cis-cat-lite.sh -b benchmarks/CIS_Ubuntu_Linux_20.04_LTS_Benchmark_v1.1.0-xccdf.xml

# For RHEL/CentOS
sudo yum install -y scap-security-guide
sudo oscap xccdf eval --profile xccdf_org.ssgproject.content_profile_cis \
    --results scan-results.xml \
    /usr/share/xml/scap/ssg/content/ssg-centos8-ds.xml

# Automated hardening with Ansible
ansible-playbook -i inventory hardening-playbook.yml \
    --extra-vars "compliance_profile=cis"</code></pre>
                    </div>
                </section>

                <section class="compliance-frameworks">
                    <h2>Compliance Frameworks</h2>

                    <h3>Supported Compliance Standards</h3>
                    <div class="compliance-grid">
                        <div class="compliance-item">
                            <h4>üìã SOC 2 Type II</h4>
                            <p><strong>Security, Availability, Processing Integrity</strong></p>
                            <ul>
                                <li>Access control implementation</li>
                                <li>System monitoring and logging</li>
                                <li>Change management procedures</li>
                                <li>Incident response protocols</li>
                                <li>Data protection measures</li>
                            </ul>
                        </div>

                        <div class="compliance-item">
                            <h4>üîê ISO 27001</h4>
                            <p><strong>Information Security Management</strong></p>
                            <ul>
                                <li>Risk assessment and treatment</li>
                                <li>Security policy documentation</li>
                                <li>Asset management controls</li>
                                <li>Supplier relationship security</li>
                                <li>Business continuity planning</li>
                            </ul>
                        </div>

                        <div class="compliance-item">
                            <h4>üèõÔ∏è FedRAMP</h4>
                            <p><strong>Federal Risk Authorization</strong></p>
                            <ul>
                                <li>NIST 800-53 control implementation</li>
                                <li>Continuous monitoring requirements</li>
                                <li>Security assessment procedures</li>
                                <li>Configuration management</li>
                                <li>Incident response capabilities</li>
                            </ul>
                        </div>

                        <div class="compliance-item">
                            <h4>üí≥ PCI DSS</h4>
                            <p><strong>Payment Card Industry</strong></p>
                            <ul>
                                <li>Network security requirements</li>
                                <li>Data protection standards</li>
                                <li>Vulnerability management</li>
                                <li>Access control implementation</li>
                                <li>Regular security testing</li>
                            </ul>
                        </div>
                    </div>

                    <h3>Compliance Implementation Guide</h3>
                    <div class="implementation-steps">
                        <h4>SOC 2 Implementation</h4>
                        <ol>
                            <li><strong>Scope Definition:</strong> Identify systems and processes in scope</li>
                            <li><strong>Control Design:</strong> Implement required security controls</li>
                            <li><strong>Documentation:</strong> Create policies and procedures</li>
                            <li><strong>Testing:</strong> Perform control effectiveness testing</li>
                            <li><strong>Monitoring:</strong> Establish continuous monitoring processes</li>
                            <li><strong>Audit:</strong> Engage qualified auditor for assessment</li>
                        </ol>

                        <h4>Control Implementation Example</h4>
                        <div class="code-block">
                            <pre><code># SOC 2 Control: CC6.1 - Logical and Physical Access Controls
# Implementation in SysManage

# 1. Access control policy configuration
ACCESS_CONTROL_POLICY = {
    "minimum_password_length": 12,
    "require_mfa": True,
    "session_timeout_minutes": 30,
    "max_failed_attempts": 5,
    "account_lockout_duration": 30,
    "privilege_escalation_approval": True
}

# 2. Role-based access control matrix
RBAC_MATRIX = {
    "admin": [
        "system:configure", "users:manage", "security:audit",
        "hosts:manage", "certificates:manage"
    ],
    "operator": [
        "hosts:manage", "packages:manage", "monitoring:view"
    ],
    "viewer": [
        "hosts:view", "packages:view", "monitoring:view"
    ],
    "auditor": [
        "audit:view", "logs:view", "reports:generate"
    ]
}

# 3. Access logging configuration
AUDIT_EVENTS = [
    "user_login", "user_logout", "permission_granted",
    "permission_denied", "role_assigned", "role_removed",
    "system_configuration_change", "security_event"
]</code></pre>
                        </div>
                    </div>
                </section>

                <section class="audit-procedures">
                    <h2>Audit Procedures</h2>

                    <h3>Audit Framework</h3>
                    <p>SysManage implements comprehensive audit capabilities for compliance and security monitoring.</p>

                    <h4>Audit Event Categories</h4>
                    <div class="audit-categories">
                        <div class="category-item">
                            <h4>üîê Authentication Events</h4>
                            <ul>
                                <li>User login/logout activities</li>
                                <li>Failed authentication attempts</li>
                                <li>Account lockouts and unlocks</li>
                                <li>Password changes and resets</li>
                                <li>MFA enrollment and usage</li>
                            </ul>
                        </div>

                        <div class="category-item">
                            <h4>‚öôÔ∏è Administrative Actions</h4>
                            <ul>
                                <li>User account management</li>
                                <li>Role and permission changes</li>
                                <li>System configuration modifications</li>
                                <li>Security setting updates</li>
                                <li>Certificate management operations</li>
                            </ul>
                        </div>

                        <div class="category-item">
                            <h4>üñ•Ô∏è System Operations</h4>
                            <ul>
                                <li>Host approval and rejection</li>
                                <li>Package installation and updates</li>
                                <li>Task execution and results</li>
                                <li>File transfers and deployments</li>
                                <li>System monitoring access</li>
                            </ul>
                        </div>

                        <div class="category-item">
                            <h4>üö® Security Events</h4>
                            <ul>
                                <li>Suspicious activity detection</li>
                                <li>Privilege escalation attempts</li>
                                <li>Unauthorized access attempts</li>
                                <li>Certificate validation failures</li>
                                <li>Data access violations</li>
                            </ul>
                        </div>
                    </div>

                    <h4>Audit Log Format</h4>
                    <div class="code-block">
                        <pre><code># Standard audit log entry format (JSON)
{
  "timestamp": "2024-01-15T14:30:00.000Z",
  "event_id": "evt_1234567890",
  "event_type": "authentication",
  "event_category": "login_success",
  "severity": "info",
  "source": {
    "service": "sysmanage-server",
    "version": "1.0.0",
    "host": "sysmanage-prod-01"
  },
  "actor": {
    "user_id": "user_123",
    "username": "jdoe",
    "session_id": "sess_abc123",
    "ip_address": "192.168.1.100",
    "user_agent": "Mozilla/5.0..."
  },
  "target": {
    "resource_type": "system",
    "resource_id": "sysmanage-server",
    "action": "login"
  },
  "details": {
    "authentication_method": "username_password",
    "mfa_used": true,
    "login_location": "New York, US",
    "previous_login": "2024-01-15T08:00:00.000Z"
  },
  "outcome": {
    "result": "success",
    "reason": null,
    "risk_score": 0.2
  }
}</code></pre>
                    </div>

                    <h3>Audit Reporting</h3>
                    <div class="reporting-features">
                        <h4>Automated Reporting</h4>
                        <ul>
                            <li><strong>Daily Security Summary:</strong> Authentication events, failed attempts, security alerts</li>
                            <li><strong>Weekly Access Report:</strong> User activities, permission changes, role assignments</li>
                            <li><strong>Monthly Compliance Report:</strong> Control effectiveness, policy violations, risk assessments</li>
                            <li><strong>Quarterly Audit Report:</strong> Comprehensive security posture review</li>
                        </ul>

                        <h4>Custom Report Generation</h4>
                        <div class="code-block">
                            <pre><code># Generate audit reports using SysManage API
curl -X POST "https://sysmanage.company.com/api/reports/audit" \
  -H "Authorization: Bearer $JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "report_type": "security_events",
    "date_range": {
      "start": "2024-01-01T00:00:00Z",
      "end": "2024-01-31T23:59:59Z"
    },
    "filters": {
      "event_types": ["authentication", "authorization", "admin_action"],
      "severity": ["medium", "high", "critical"],
      "users": ["admin", "operator"]
    },
    "format": "pdf",
    "delivery": {
      "method": "email",
      "recipients": ["security@company.com", "compliance@company.com"]
    }
  }'</code></pre>
                        </div>
                    </div>
                </section>

                <section class="incident-response">
                    <h2>Incident Response</h2>

                    <h3>Incident Response Framework</h3>
                    <p>SysManage implements a structured incident response process following NIST guidelines.</p>

                    <div class="ir-phases">
                        <h4>Incident Response Phases</h4>
                        <div class="phases-grid">
                            <div class="phase-item">
                                <h4>1. üìã Preparation</h4>
                                <ul>
                                    <li>Incident response plan development</li>
                                    <li>Team roles and responsibilities</li>
                                    <li>Communication procedures</li>
                                    <li>Tool and resource preparation</li>
                                    <li>Training and awareness programs</li>
                                </ul>
                            </div>

                            <div class="phase-item">
                                <h4>2. üîç Detection & Analysis</h4>
                                <ul>
                                    <li>Automated threat detection</li>
                                    <li>Security event correlation</li>
                                    <li>Incident classification</li>
                                    <li>Impact assessment</li>
                                    <li>Evidence collection</li>
                                </ul>
                            </div>

                            <div class="phase-item">
                                <h4>3. üö® Containment & Eradication</h4>
                                <ul>
                                    <li>Immediate containment actions</li>
                                    <li>System isolation procedures</li>
                                    <li>Threat neutralization</li>
                                    <li>Vulnerability remediation</li>
                                    <li>System hardening</li>
                                </ul>
                            </div>

                            <div class="phase-item">
                                <h4>4. üîÑ Recovery & Lessons Learned</h4>
                                <ul>
                                    <li>System restoration procedures</li>
                                    <li>Monitoring for reoccurrence</li>
                                    <li>Post-incident analysis</li>
                                    <li>Process improvements</li>
                                    <li>Documentation updates</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <h3>Automated Incident Detection</h3>
                    <div class="detection-rules">
                        <h4>Security Event Rules</h4>
                        <div class="code-block">
                            <pre><code># Incident detection rules configuration
INCIDENT_RULES = {
    "brute_force_attack": {
        "condition": "failed_logins >= 10 within 5 minutes",
        "severity": "high",
        "actions": ["block_ip", "notify_admin", "create_incident"]
    },
    "privilege_escalation": {
        "condition": "sudo_usage by non_admin_user",
        "severity": "critical",
        "actions": ["log_event", "notify_security_team", "require_justification"]
    },
    "unusual_access_pattern": {
        "condition": "login from new_location AND new_device",
        "severity": "medium",
        "actions": ["require_mfa", "notify_user", "monitor_session"]
    },
    "certificate_validation_failure": {
        "condition": "mtls_validation_failure >= 5 within 1 minute",
        "severity": "high",
        "actions": ["block_agent", "investigate_source", "notify_admin"]
    }
}

# Automated response actions
def handle_security_incident(rule_name: str, event_data: dict):
    incident = create_incident_record(rule_name, event_data)

    # Execute automated responses
    for action in INCIDENT_RULES[rule_name]["actions"]:
        execute_response_action(action, event_data)

    # Notify response team
    notify_incident_response_team(incident)

    return incident.id</code></pre>
                        </div>
                    </div>

                    <h3>Incident Response Playbooks</h3>
                    <div class="playbooks">
                        <h4>Compromised User Account Playbook</h4>
                        <ol>
                            <li><strong>Immediate Actions:</strong>
                                <ul>
                                    <li>Disable compromised user account</li>
                                    <li>Revoke all active JWT tokens</li>
                                    <li>Reset account password</li>
                                    <li>Block source IP addresses</li>
                                </ul>
                            </li>
                            <li><strong>Investigation:</strong>
                                <ul>
                                    <li>Review audit logs for account activity</li>
                                    <li>Identify accessed resources and data</li>
                                    <li>Check for lateral movement attempts</li>
                                    <li>Analyze authentication patterns</li>
                                </ul>
                            </li>
                            <li><strong>Recovery:</strong>
                                <ul>
                                    <li>Re-enable account with new credentials</li>
                                    <li>Require MFA re-enrollment</li>
                                    <li>Monitor account for suspicious activity</li>
                                    <li>Update security awareness training</li>
                                </ul>
                            </li>
                        </ol>

                        <h4>Agent Communication Compromise</h4>
                        <ol>
                            <li><strong>Immediate Actions:</strong>
                                <ul>
                                    <li>Revoke suspected agent certificates</li>
                                    <li>Block agent IP addresses</li>
                                    <li>Isolate affected network segments</li>
                                    <li>Enable enhanced monitoring</li>
                                </ul>
                            </li>
                            <li><strong>Investigation:</strong>
                                <ul>
                                    <li>Analyze mTLS certificate validation logs</li>
                                    <li>Review agent communication patterns</li>
                                    <li>Check for unauthorized commands</li>
                                    <li>Verify certificate chain integrity</li>
                                </ul>
                            </li>
                            <li><strong>Recovery:</strong>
                                <ul>
                                    <li>Generate new agent certificates</li>
                                    <li>Update certificate authority if needed</li>
                                    <li>Strengthen certificate validation</li>
                                    <li>Implement additional monitoring</li>
                                </ul>
                            </li>
                        </ol>
                    </div>
                </section>

                <section class="security-monitoring">
                    <h2>Continuous Security Monitoring</h2>

                    <h3>Monitoring Architecture</h3>
                    <p>Implement comprehensive monitoring for real-time threat detection and response.</p>

                    <div class="monitoring-layers">
                        <h4>Monitoring Layers</h4>
                        <div class="layers-grid">
                            <div class="layer-item">
                                <h4>üñ•Ô∏è Infrastructure Monitoring</h4>
                                <ul>
                                    <li>System resource utilization</li>
                                    <li>Network traffic analysis</li>
                                    <li>Service availability monitoring</li>
                                    <li>Performance metrics tracking</li>
                                </ul>
                            </div>

                            <div class="layer-item">
                                <h4>üì± Application Monitoring</h4>
                                <ul>
                                    <li>API endpoint performance</li>
                                    <li>Database query monitoring</li>
                                    <li>Error rate and patterns</li>
                                    <li>User session tracking</li>
                                </ul>
                            </div>

                            <div class="layer-item">
                                <h4>üîí Security Monitoring</h4>
                                <ul>
                                    <li>Authentication event monitoring</li>
                                    <li>Authorization failure tracking</li>
                                    <li>Suspicious activity detection</li>
                                    <li>Certificate status monitoring</li>
                                </ul>
                            </div>

                            <div class="layer-item">
                                <h4>üìä Business Monitoring</h4>
                                <ul>
                                    <li>Host management activities</li>
                                    <li>Package deployment metrics</li>
                                    <li>User adoption patterns</li>
                                    <li>Compliance status tracking</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <h4>Monitoring Tool Integration</h4>
                    <div class="code-block">
                        <pre><code># Prometheus monitoring configuration
# /etc/prometheus/prometheus.yml
global:
  scrape_interval: 15s
  evaluation_interval: 15s

rule_files:
  - "sysmanage_alerts.yml"

scrape_configs:
  - job_name: 'sysmanage-server'
    static_configs:
      - targets: ['localhost:8000']
    metrics_path: '/metrics'
    scrape_interval: 5s

  - job_name: 'sysmanage-database'
    static_configs:
      - targets: ['localhost:9187']
    scrape_interval: 10s

alerting:
  alertmanagers:
    - static_configs:
        - targets:
          - alertmanager:9093

# Alert rules for security events
groups:
  - name: sysmanage_security
    rules:
      - alert: HighFailedLogins
        expr: rate(sysmanage_failed_logins_total[5m]) > 0.1
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "High rate of failed login attempts"

      - alert: SuspiciousActivity
        expr: sysmanage_security_events_total{severity="high"} > 0
        for: 0m
        labels:
          severity: critical
        annotations:
          summary: "Critical security event detected"</code></pre>
                    </div>
                </section>

                <section class="data-protection">
                    <h2>Data Protection & Privacy</h2>

                    <h3>Data Classification</h3>
                    <div class="data-classes">
                        <div class="class-item">
                            <h4>üî¥ Highly Sensitive</h4>
                            <ul>
                                <li>User passwords and authentication tokens</li>
                                <li>Private keys and certificates</li>
                                <li>Personal identifiable information (PII)</li>
                                <li>Security configuration details</li>
                            </ul>
                        </div>

                        <div class="class-item">
                            <h4>üü° Sensitive</h4>
                            <ul>
                                <li>System configuration data</li>
                                <li>Host inventory information</li>
                                <li>Package installation details</li>
                                <li>User activity logs</li>
                            </ul>
                        </div>

                        <div class="class-item">
                            <h4>üü¢ Internal</h4>
                            <ul>
                                <li>System performance metrics</li>
                                <li>Non-sensitive log entries</li>
                                <li>Public configuration templates</li>
                                <li>Documentation and guides</li>
                            </ul>
                        </div>
                    </div>

                    <h3>Data Protection Measures</h3>
                    <div class="protection-measures">
                        <h4>Encryption Implementation</h4>
                        <div class="code-block">
                            <pre><code># Data encryption configuration
ENCRYPTION_CONFIG = {
    "database": {
        "encryption_at_rest": True,
        "algorithm": "AES-256",
        "key_rotation_days": 90
    },
    "backups": {
        "encryption_enabled": True,
        "algorithm": "AES-256-GCM",
        "compression": True
    },
    "logs": {
        "pii_redaction": True,
        "encryption_in_transit": True,
        "retention_days": 365
    },
    "certificates": {
        "storage_encryption": True,
        "access_control": "strict",
        "audit_logging": True
    }
}

# PII redaction for logs
import re

def redact_sensitive_data(log_message: str) -> str:
    # Redact email addresses
    log_message = re.sub(r'\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b',
                        '[EMAIL_REDACTED]', log_message)

    # Redact IP addresses
    log_message = re.sub(r'\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b',
                        '[IP_REDACTED]', log_message)

    # Redact JWT tokens
    log_message = re.sub(r'eyJ[A-Za-z0-9-_]+\.eyJ[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+',
                        '[TOKEN_REDACTED]', log_message)

    return log_message</code></pre>
                        </div>
                    </div>
                </section>

                <section class="disaster-recovery">
                    <h2>Disaster Recovery & Business Continuity</h2>

                    <h3>Backup Strategy</h3>
                    <div class="backup-strategy">
                        <h4>3-2-1 Backup Rule Implementation</h4>
                        <ul>
                            <li><strong>3 Copies:</strong> Production data + 2 backup copies</li>
                            <li><strong>2 Media Types:</strong> Local storage + cloud storage</li>
                            <li><strong>1 Offsite:</strong> Geographically separated location</li>
                        </ul>

                        <h4>Backup Components</h4>
                        <div class="code-block">
                            <pre><code># Automated backup script
#!/bin/bash
# /usr/local/bin/sysmanage-backup.sh

BACKUP_DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/var/backups/sysmanage"
S3_BUCKET="s3://company-backups/sysmanage"

# Database backup
pg_dump -h localhost -U sysmanage_user sysmanage_db | \
    gzip > "$BACKUP_DIR/db_backup_$BACKUP_DATE.sql.gz"

# Configuration backup
tar -czf "$BACKUP_DIR/config_backup_$BACKUP_DATE.tar.gz" \
    /etc/sysmanage/ \
    /etc/ssl/sysmanage/ \
    /var/lib/sysmanage/

# Certificate backup (encrypted)
gpg --cipher-algo AES256 --compress-algo 1 --s2k-mode 3 \
    --s2k-digest-algo SHA512 --s2k-count 65536 --symmetric \
    --output "$BACKUP_DIR/certs_backup_$BACKUP_DATE.tar.gz.gpg" \
    /var/lib/sysmanage/certs/

# Upload to cloud storage
aws s3 sync "$BACKUP_DIR" "$S3_BUCKET" --delete

# Clean old backups (keep 30 days local, 365 days cloud)
find "$BACKUP_DIR" -type f -mtime +30 -delete
aws s3 ls "$S3_BUCKET" --recursive | \
    awk '$1 < "'$(date -d '365 days ago' '+%Y-%m-%d')'" {print $4}' | \
    xargs -I {} aws s3 rm "$S3_BUCKET/{}"</code></pre>
                        </div>
                    </div>

                    <h3>Recovery Procedures</h3>
                    <div class="recovery-procedures">
                        <h4>Recovery Time Objectives (RTO)</h4>
                        <ul>
                            <li><strong>Critical Systems:</strong> 1 hour</li>
                            <li><strong>Production Environment:</strong> 4 hours</li>
                            <li><strong>Full Service Restoration:</strong> 24 hours</li>
                        </ul>

                        <h4>Recovery Point Objectives (RPO)</h4>
                        <ul>
                            <li><strong>Database:</strong> 15 minutes (continuous replication)</li>
                            <li><strong>Configuration:</strong> 1 hour (hourly backups)</li>
                            <li><strong>Logs:</strong> 1 hour (real-time shipping)</li>
                        </ul>
                    </div>
                </section>

                <section class="performance-security">
                    <h2>Security Performance Optimization</h2>

                    <h3>Balancing Security and Performance</h3>
                    <div class="optimization-areas">
                        <div class="area-item">
                            <h4>‚ö° Authentication Optimization</h4>
                            <ul>
                                <li>JWT token caching for validation</li>
                                <li>Efficient RBAC permission lookups</li>
                                <li>Connection pooling for external auth</li>
                                <li>Optimized password hashing (Argon2)</li>
                            </ul>
                        </div>

                        <div class="area-item">
                            <h4>üîí TLS Performance</h4>
                            <ul>
                                <li>TLS session resumption</li>
                                <li>HTTP/2 with server push</li>
                                <li>Certificate caching</li>
                                <li>Cipher suite optimization</li>
                            </ul>
                        </div>

                        <div class="area-item">
                            <h4>üìä Monitoring Efficiency</h4>
                            <ul>
                                <li>Selective audit logging</li>
                                <li>Asynchronous security checks</li>
                                <li>Batched metric collection</li>
                                <li>Intelligent alerting rules</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section class="security-training">
                    <h2>Security Training & Awareness</h2>

                    <h3>Training Program</h3>
                    <div class="training-modules">
                        <div class="module-item">
                            <h4>üë§ User Security Training</h4>
                            <ul>
                                <li>Password security best practices</li>
                                <li>Multi-factor authentication setup</li>
                                <li>Phishing and social engineering awareness</li>
                                <li>Incident reporting procedures</li>
                            </ul>
                        </div>

                        <div class="module-item">
                            <h4>üë®‚Äçüíº Administrator Training</h4>
                            <ul>
                                <li>System hardening procedures</li>
                                <li>Certificate management</li>
                                <li>Incident response protocols</li>
                                <li>Compliance requirements</li>
                            </ul>
                        </div>

                        <div class="module-item">
                            <h4>üîß Developer Security Training</h4>
                            <ul>
                                <li>Secure coding practices</li>
                                <li>API security implementation</li>
                                <li>Vulnerability assessment</li>
                                <li>Security testing methodologies</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section class="next-steps">
                    <h2>Next Steps</h2>
                    <p>After implementing security best practices:</p>
                    <ol>
                        <li><strong><a href="authentication.html">Authentication Setup</a>:</strong> Configure robust authentication systems</li>
                        <li><strong><a href="mtls.html">mTLS Implementation</a>:</strong> Set up certificate-based agent authentication</li>
                        <li><strong><a href="network-security.html">Network Security</a>:</strong> Implement network-level protections</li>
                        <li><strong><a href="scanning.html">Security Scanning</a>:</strong> Deploy automated security scanning</li>
                    </ol>
                </section>
            </div>

            <div class="docs-footer">
                <div class="docs-navigation">
                    <h3>Navigation</h3>
                    <div class="nav-links">
                        <a href="authentication.html" class="nav-link">‚Üê Authentication</a>
                        <a href="mtls.html" class="nav-link">Mutual TLS ‚Üí</a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2024 SysManage. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="../../assets/js/navbar.js"></script>
    <script src="../../assets/js/main.js"></script>
    <script src="../../assets/js/i18n.js"></script>
</body>
</html>