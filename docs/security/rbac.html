<!DOCTYPE html>
<html lang="en" data-i18n-title="rbac_docs.title">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="rbac_docs.title" data-i18n-html>Role-Based Access Control - SysManage</title>
    <meta name="description" content="Comprehensive documentation for SysManage's role-based access control system with defense-in-depth security." data-i18n-attr="content" data-i18n="rbac_docs.description" data-i18n-html>
    <link rel="stylesheet" href="../../assets/css/style.css">
    <link rel="icon" type="image/svg+xml" href="../../assets/images/favicon.svg">
</head>
<body>
    <header class="site-header">
        <nav class="navbar">
            <div class="container">
                <div class="nav-brand">
                    <a href="../../">
                        <img src="../../assets/images/sysmanage-logo.svg" alt="SysManage" class="logo">
                    </a>
                </div>
                <div class="nav-menu">
                    <a href="../../#features" class="nav-link" data-i18n="nav.features" data-i18n-html>Features</a>
                    <a href="../../#getting-started" class="nav-link" data-i18n="nav.getting_started" data-i18n-html>Getting Started</a>
                    <a href="../" class="nav-link active" data-i18n="nav.documentation" data-i18n-html>Documentation</a>
                    <a href="../../config-builder.html" class="nav-link" data-i18n="nav.config_builder" data-i18n-html>Configuration Builder</a>
                    <a href="https://github.com/bceverly/sysmanage" class="nav-link" target="_blank" data-i18n="nav.github" data-i18n-html>GitHub</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="docs-main">
        <div class="container">
            <div class="docs-breadcrumb">
                <a href="../" data-i18n="nav.documentation" data-i18n-html>Documentation</a> >
                <a href="index.html" data-i18n="security_docs.section_title" data-i18n-html>Security</a> >
                <span data-i18n="rbac_docs.breadcrumb" data-i18n-html>RBAC</span>
            </div>

            <div class="docs-header">
                <h1 data-i18n="rbac_docs.header.title" data-i18n-html>Role-Based Access Control (RBAC)</h1>
                <p data-i18n="rbac_docs.header.subtitle" data-i18n-html>Fine-grained security permissions with defense-in-depth protection for all SysManage operations.</p>
            </div>

            <div class="docs-content">
                <section class="docs-overview">
                    <h2 data-i18n="rbac_docs.overview.title" data-i18n-html>Security Model Overview</h2>
                    <p data-i18n="rbac_docs.overview.description" data-i18n-html>SysManage implements a comprehensive role-based access control (RBAC) system that provides fine-grained permissions for every operation in the platform. The system is built on a defense-in-depth security model, ensuring that security checks are enforced at multiple layers.</p>

                    <div class="security-features">
                        <h3 data-i18n="rbac_docs.defense_in_depth.title" data-i18n-html>Defense-in-Depth Architecture</h3>
                        <p data-i18n="rbac_docs.defense_in_depth.description" data-i18n-html>Every protected operation in SysManage uses a two-layer security validation approach:</p>

                        <div class="features-grid">
                            <div class="feature-item">
                                <h4 data-i18n="rbac_docs.defense_in_depth.layer1.title" data-i18n-html>üñ•Ô∏è Frontend Layer</h4>
                                <p data-i18n="rbac_docs.defense_in_depth.layer1.description" data-i18n-html>UI elements (buttons, menus, actions) are hidden or disabled based on user permissions. This prevents users from attempting unauthorized actions and provides a better user experience.</p>
                            </div>
                            <div class="feature-item">
                                <h4 data-i18n="rbac_docs.defense_in_depth.layer2.title" data-i18n-html>üîí Backend Layer</h4>
                                <p data-i18n="rbac_docs.defense_in_depth.layer2.description" data-i18n-html>API endpoints validate user permissions before executing any operation. Even if the frontend is bypassed, the backend enforces security with HTTP 403 errors for unauthorized access.</p>
                            </div>
                        </div>

                        <div class="info-box">
                            <h4 data-i18n="rbac_docs.defense_in_depth.why.title" data-i18n-html>Why Two Layers?</h4>
                            <p data-i18n="rbac_docs.defense_in_depth.why.description" data-i18n-html>The frontend layer cannot be trusted for security enforcement since it runs in the user's browser and can be manipulated. The backend layer provides the actual security guarantee. Together, they offer both security (backend) and usability (frontend).</p>
                        </div>
                    </div>
                </section>

                <section class="docs-section">
                    <h2 data-i18n="rbac_docs.role_groups.title" data-i18n-html>Security Role Groups</h2>
                    <p data-i18n="rbac_docs.role_groups.description" data-i18n-html>Security roles are organized into logical groups based on the functional areas they control:</p>

                    <div class="role-groups">
                        <!-- Host Management -->
                        <div class="role-group-card">
                            <h3 data-i18n="rbac_docs.groups.host_management.title" data-i18n-html>üñ•Ô∏è Host Management</h3>
                            <p data-i18n="rbac_docs.groups.host_management.description" data-i18n-html>Controls for managing hosts, their lifecycle, and operational states.</p>
                            <ul class="role-list">
                                <li><strong data-i18n="rbac_docs.roles.approve_host_registration" data-i18n-html>Approve Host Registration</strong> - <span data-i18n="rbac_docs.roles.approve_host_registration_desc" data-i18n-html>Approve or reject new host registration requests</span></li>
                                <li><strong data-i18n="rbac_docs.roles.delete_host" data-i18n-html>Delete Host</strong> - <span data-i18n="rbac_docs.roles.delete_host_desc" data-i18n-html>Remove hosts from the system</span></li>
                                <li><strong data-i18n="rbac_docs.roles.view_host_details" data-i18n-html>View Host Details</strong> - <span data-i18n="rbac_docs.roles.view_host_details_desc" data-i18n-html>Access detailed information about hosts</span></li>
                                <li><strong data-i18n="rbac_docs.roles.reboot_host" data-i18n-html>Reboot Host</strong> - <span data-i18n="rbac_docs.roles.reboot_host_desc" data-i18n-html>Initiate host reboots</span></li>
                                <li><strong data-i18n="rbac_docs.roles.shutdown_host" data-i18n-html>Shutdown Host</strong> - <span data-i18n="rbac_docs.roles.shutdown_host_desc" data-i18n-html>Shut down hosts</span></li>
                                <li><strong data-i18n="rbac_docs.roles.edit_tags" data-i18n-html>Edit Tags</strong> - <span data-i18n="rbac_docs.roles.edit_tags_desc" data-i18n-html>Modify host tags for organization</span></li>
                                <li><strong data-i18n="rbac_docs.roles.stop_host_service" data-i18n-html>Stop Host Service</strong> - <span data-i18n="rbac_docs.roles.stop_host_service_desc" data-i18n-html>Stop services running on hosts</span></li>
                                <li><strong data-i18n="rbac_docs.roles.start_host_service" data-i18n-html>Start Host Service</strong> - <span data-i18n="rbac_docs.roles.start_host_service_desc" data-i18n-html>Start services on hosts</span></li>
                                <li><strong data-i18n="rbac_docs.roles.restart_host_service" data-i18n-html>Restart Host Service</strong> - <span data-i18n="rbac_docs.roles.restart_host_service_desc" data-i18n-html>Restart services running on hosts</span></li>
                            </ul>
                        </div>

                        <!-- Package Management -->
                        <div class="role-group-card">
                            <h3 data-i18n="rbac_docs.groups.package_management.title" data-i18n-html>üì¶ Package Management</h3>
                            <p data-i18n="rbac_docs.groups.package_management.description" data-i18n-html>Controls for software package operations and OS upgrades.</p>
                            <ul class="role-list">
                                <li><strong data-i18n="rbac_docs.roles.add_package" data-i18n-html>Add Package</strong> - <span data-i18n="rbac_docs.roles.add_package_desc" data-i18n-html>Install new software packages on hosts</span></li>
                                <li><strong data-i18n="rbac_docs.roles.apply_software_update" data-i18n-html>Apply Software Update</strong> - <span data-i18n="rbac_docs.roles.apply_software_update_desc" data-i18n-html>Apply available package updates</span></li>
                                <li><strong data-i18n="rbac_docs.roles.apply_host_os_upgrade" data-i18n-html>Apply Host OS Upgrade</strong> - <span data-i18n="rbac_docs.roles.apply_host_os_upgrade_desc" data-i18n-html>Perform major OS version upgrades</span></li>
                            </ul>
                        </div>

                        <!-- Secrets Management -->
                        <div class="role-group-card">
                            <h3 data-i18n="rbac_docs.groups.secrets_management.title" data-i18n-html>üîê Secrets Management</h3>
                            <p data-i18n="rbac_docs.groups.secrets_management.description" data-i18n-html>Controls for OpenBAO vault and secrets operations.</p>
                            <ul class="role-list">
                                <li><strong data-i18n="rbac_docs.roles.deploy_ssh_key" data-i18n-html>Deploy SSH Key</strong> - <span data-i18n="rbac_docs.roles.deploy_ssh_key_desc" data-i18n-html>Deploy SSH keys to hosts</span></li>
                                <li><strong data-i18n="rbac_docs.roles.deploy_certificate" data-i18n-html>Deploy Certificate</strong> - <span data-i18n="rbac_docs.roles.deploy_certificate_desc" data-i18n-html>Deploy SSL/TLS certificates to hosts</span></li>
                                <li><strong data-i18n="rbac_docs.roles.add_secret" data-i18n-html>Add Secret</strong> - <span data-i18n="rbac_docs.roles.add_secret_desc" data-i18n-html>Create new secrets in the vault</span></li>
                                <li><strong data-i18n="rbac_docs.roles.delete_secret" data-i18n-html>Delete Secret</strong> - <span data-i18n="rbac_docs.roles.delete_secret_desc" data-i18n-html>Remove secrets from the vault</span></li>
                                <li><strong data-i18n="rbac_docs.roles.edit_secret" data-i18n-html>Edit Secret</strong> - <span data-i18n="rbac_docs.roles.edit_secret_desc" data-i18n-html>Modify existing secrets</span></li>
                                <li><strong data-i18n="rbac_docs.roles.stop_vault" data-i18n-html>Stop Vault</strong> - <span data-i18n="rbac_docs.roles.stop_vault_desc" data-i18n-html>Stop the OpenBAO vault service</span></li>
                                <li><strong data-i18n="rbac_docs.roles.start_vault" data-i18n-html>Start Vault</strong> - <span data-i18n="rbac_docs.roles.start_vault_desc" data-i18n-html>Start the OpenBAO vault service</span></li>
                            </ul>
                        </div>

                        <!-- User Management -->
                        <div class="role-group-card">
                            <h3 data-i18n="rbac_docs.groups.user_management.title" data-i18n-html>üë• User Management</h3>
                            <p data-i18n="rbac_docs.groups.user_management.description" data-i18n-html>Controls for managing SysManage users and their accounts.</p>
                            <ul class="role-list">
                                <li><strong data-i18n="rbac_docs.roles.add_user" data-i18n-html>Add User</strong> - <span data-i18n="rbac_docs.roles.add_user_desc" data-i18n-html>Create new user accounts</span></li>
                                <li><strong data-i18n="rbac_docs.roles.edit_user" data-i18n-html>Edit User</strong> - <span data-i18n="rbac_docs.roles.edit_user_desc" data-i18n-html>Modify user account details</span></li>
                                <li><strong data-i18n="rbac_docs.roles.lock_user" data-i18n-html>Lock User</strong> - <span data-i18n="rbac_docs.roles.lock_user_desc" data-i18n-html>Lock user accounts to prevent access</span></li>
                                <li><strong data-i18n="rbac_docs.roles.unlock_user" data-i18n-html>Unlock User</strong> - <span data-i18n="rbac_docs.roles.unlock_user_desc" data-i18n-html>Unlock previously locked user accounts</span></li>
                                <li><strong data-i18n="rbac_docs.roles.delete_user" data-i18n-html>Delete User</strong> - <span data-i18n="rbac_docs.roles.delete_user_desc" data-i18n-html>Remove user accounts from the system</span></li>
                                <li><strong data-i18n="rbac_docs.roles.reset_user_password" data-i18n-html>Reset User Password</strong> - <span data-i18n="rbac_docs.roles.reset_user_password_desc" data-i18n-html>Reset passwords for user accounts</span></li>
                            </ul>
                        </div>

                        <!-- Script Management -->
                        <div class="role-group-card">
                            <h3 data-i18n="rbac_docs.groups.script_management.title" data-i18n-html>üìú Script Management</h3>
                            <p data-i18n="rbac_docs.groups.script_management.description" data-i18n-html>Controls for managing and executing scripts on hosts.</p>
                            <ul class="role-list">
                                <li><strong data-i18n="rbac_docs.roles.add_script" data-i18n-html>Add Script</strong> - <span data-i18n="rbac_docs.roles.add_script_desc" data-i18n-html>Create new scripts in the library</span></li>
                                <li><strong data-i18n="rbac_docs.roles.edit_script" data-i18n-html>Edit Script</strong> - <span data-i18n="rbac_docs.roles.edit_script_desc" data-i18n-html>Modify existing scripts</span></li>
                                <li><strong data-i18n="rbac_docs.roles.delete_script" data-i18n-html>Delete Script</strong> - <span data-i18n="rbac_docs.roles.delete_script_desc" data-i18n-html>Remove scripts from the library</span></li>
                                <li><strong data-i18n="rbac_docs.roles.run_script" data-i18n-html>Run Script</strong> - <span data-i18n="rbac_docs.roles.run_script_desc" data-i18n-html>Execute scripts on hosts</span></li>
                                <li><strong data-i18n="rbac_docs.roles.delete_script_execution" data-i18n-html>Delete Script Execution</strong> - <span data-i18n="rbac_docs.roles.delete_script_execution_desc" data-i18n-html>Remove script execution history</span></li>
                            </ul>
                        </div>

                        <!-- Report Management -->
                        <div class="role-group-card">
                            <h3 data-i18n="rbac_docs.groups.report_management.title" data-i18n-html>üìä Report Management</h3>
                            <p data-i18n="rbac_docs.groups.report_management.description" data-i18n-html>Controls for viewing and generating system reports.</p>
                            <ul class="role-list">
                                <li><strong data-i18n="rbac_docs.roles.view_report" data-i18n-html>View Report</strong> - <span data-i18n="rbac_docs.roles.view_report_desc" data-i18n-html>View reports in the web interface</span></li>
                                <li><strong data-i18n="rbac_docs.roles.generate_pdf_report" data-i18n-html>Generate PDF Report</strong> - <span data-i18n="rbac_docs.roles.generate_pdf_report_desc" data-i18n-html>Export reports as PDF documents</span></li>
                            </ul>
                        </div>

                        <!-- Integration Management -->
                        <div class="role-group-card">
                            <h3 data-i18n="rbac_docs.groups.integration_management.title" data-i18n-html>üîó Integration Management</h3>
                            <p data-i18n="rbac_docs.groups.integration_management.description" data-i18n-html>Controls for managing system integrations and message queues.</p>
                            <ul class="role-list">
                                <li><strong data-i18n="rbac_docs.roles.delete_queue_message" data-i18n-html>Delete Queue Message</strong> - <span data-i18n="rbac_docs.roles.delete_queue_message_desc" data-i18n-html>Remove messages from the message queue</span></li>
                                <li><strong data-i18n="rbac_docs.roles.enable_grafana_integration" data-i18n-html>Enable Grafana Integration</strong> - <span data-i18n="rbac_docs.roles.enable_grafana_integration_desc" data-i18n-html>Configure and enable Grafana integration</span></li>
                            </ul>
                        </div>

                        <!-- Ubuntu Pro Management -->
                        <div class="role-group-card">
                            <h3 data-i18n="rbac_docs.groups.ubuntu_pro.title" data-i18n-html>üî∑ Ubuntu Pro Management</h3>
                            <p data-i18n="rbac_docs.groups.ubuntu_pro.description" data-i18n-html>Controls for Ubuntu Pro subscription management.</p>
                            <ul class="role-list">
                                <li><strong data-i18n="rbac_docs.roles.attach_ubuntu_pro" data-i18n-html>Attach Ubuntu Pro</strong> - <span data-i18n="rbac_docs.roles.attach_ubuntu_pro_desc" data-i18n-html>Attach Ubuntu Pro subscriptions to hosts</span></li>
                                <li><strong data-i18n="rbac_docs.roles.detach_ubuntu_pro" data-i18n-html>Detach Ubuntu Pro</strong> - <span data-i18n="rbac_docs.roles.detach_ubuntu_pro_desc" data-i18n-html>Detach Ubuntu Pro subscriptions from hosts</span></li>
                                <li><strong data-i18n="rbac_docs.roles.change_ubuntu_pro_master_key" data-i18n-html>Change Ubuntu Pro Master Key</strong> - <span data-i18n="rbac_docs.roles.change_ubuntu_pro_master_key_desc" data-i18n-html>Update the Ubuntu Pro master token</span></li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section class="docs-section">
                    <h2 data-i18n="rbac_docs.implementation.title" data-i18n-html>Implementation Details</h2>

                    <div class="implementation-details">
                        <h3 data-i18n="rbac_docs.implementation.frontend.title" data-i18n-html>Frontend Permission Checks</h3>
                        <p data-i18n="rbac_docs.implementation.frontend.description" data-i18n-html>The React frontend uses the <code>hasPermission()</code> function to check user permissions. UI elements are conditionally rendered based on these checks:</p>

                        <div class="code-example">
                            <pre><code>// Check permission
const [canDeleteHost, setCanDeleteHost] = useState(false);

useEffect(() => {
  const checkPermissions = async () => {
    const permission = await hasPermission(SecurityRoles.DELETE_HOST);
    setCanDeleteHost(permission);
  };
  checkPermissions();
}, []);

// Conditional rendering
{canDeleteHost && (
  &lt;Button onClick={handleDelete}&gt;Delete Host&lt;/Button&gt;
)}</code></pre>
                        </div>

                        <h3 data-i18n="rbac_docs.implementation.backend.title" data-i18n-html>Backend Permission Validation</h3>
                        <p data-i18n="rbac_docs.implementation.backend.description" data-i18n-html>FastAPI endpoints validate user roles before executing operations. Unauthorized access returns HTTP 403:</p>

                        <div class="code-example">
                            <pre><code>@router.delete("/host/{host_id}")
async def delete_host(
    host_id: UUID,
    current_user=Depends(get_current_user)
):
    with session_local() as session:
        auth_user = session.query(User).filter(
            User.userid == current_user
        ).first()

        if not auth_user.has_role(SecurityRoles.DELETE_HOST):
            raise HTTPException(
                status_code=403,
                detail="Permission denied: DELETE_HOST role required"
            )

        # Proceed with deletion
        ...</code></pre>
                        </div>

                        <h3 data-i18n="rbac_docs.implementation.assignment.title" data-i18n-html>Role Assignment</h3>
                        <p data-i18n="rbac_docs.implementation.assignment.description" data-i18n-html>Administrators can assign roles to users through the Settings ‚Üí Users interface. Multiple roles can be assigned to each user, providing flexible permission combinations for different organizational needs.</p>
                    </div>
                </section>

                <section class="docs-section">
                    <h2 data-i18n="rbac_docs.best_practices.title" data-i18n-html>Best Practices</h2>

                    <div class="best-practices">
                        <div class="practice-item">
                            <h3 data-i18n="rbac_docs.best_practices.least_privilege.title" data-i18n-html>üîí Principle of Least Privilege</h3>
                            <p data-i18n="rbac_docs.best_practices.least_privilege.description" data-i18n-html>Grant users only the minimum roles necessary to perform their job functions. Avoid giving broad permissions unless absolutely required.</p>
                        </div>

                        <div class="practice-item">
                            <h3 data-i18n="rbac_docs.best_practices.role_review.title" data-i18n-html>üîç Regular Role Reviews</h3>
                            <p data-i18n="rbac_docs.best_practices.role_review.description" data-i18n-html>Periodically review user role assignments to ensure they remain appropriate. Remove roles when users change responsibilities or leave the organization.</p>
                        </div>

                        <div class="practice-item">
                            <h3 data-i18n="rbac_docs.best_practices.separation.title" data-i18n-html>üîê Separation of Duties</h3>
                            <p data-i18n="rbac_docs.best_practices.separation.description" data-i18n-html>For sensitive operations, consider separating approval and execution roles across different users to prevent unauthorized actions.</p>
                        </div>

                        <div class="practice-item">
                            <h3 data-i18n="rbac_docs.best_practices.audit.title" data-i18n-html>üìù Audit Logging</h3>
                            <p data-i18n="rbac_docs.best_practices.audit.description" data-i18n-html>Monitor and review audit logs for role assignments and permission-based actions to detect potential security issues.</p>
                        </div>
                    </div>
                </section>

                <div class="docs-footer">
                    <div class="docs-navigation">
                        <h3 data-i18n="rbac_docs.footer.quick_nav" data-i18n-html>Quick Navigation</h3>
                        <div class="nav-links">
                            <a href="authentication.html" class="nav-link" data-i18n="rbac_docs.footer.auth_link" data-i18n-html>‚Üê Authentication</a>
                            <a href="index.html" class="nav-link" data-i18n="rbac_docs.footer.security_index" data-i18n-html>Security Documentation ‚Üí</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2024 SysManage. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="../../assets/js/i18n.js"></script>
    <script src="../../assets/js/navbar.js"></script>
    <script src="../../assets/js/main.js"></script>
</body>
</html>
