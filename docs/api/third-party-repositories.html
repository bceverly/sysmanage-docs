<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Third-Party Repositories API - SysManage</title>
    <meta name="description" content="SysManage Third-Party Repositories API documentation for managing package repositories across multiple platforms.">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="icon" type="image/svg+xml" href="/assets/images/favicon.svg">
</head>
<body data-auto-header="documentation" data-auto-footer>
    <!-- Header injected automatically by components.js -->

    <main class="docs-main">
        <div class="container">
            <div class="docs-breadcrumb">
                <a href="../">Documentation</a> > <a href="./">API Reference</a> > <span>Third-Party Repositories</span>
            </div>

            <div class="docs-header">
                <h1>Third-Party Repositories API</h1>
                <p>Centralized management of third-party package repositories across multiple operating systems and platforms.</p>
            </div>

            <div class="docs-content">
                <section class="overview">
                    <h2>Overview</h2>
                    <p>The Third-Party Repositories API provides centralized management of package repositories across Debian, Ubuntu, RHEL-based, SUSE-based, FreeBSD, NetBSD, Windows, and macOS systems. Repositories are automatically distributed to matching hosts based on OS name and version.</p>

                    <div class="api-features">
                        <h3>Key Features</h3>
                        <ul>
                            <li><strong>Automatic OS Detection:</strong> Repositories are automatically sent to all hosts matching the specified OS and version</li>
                            <li><strong>GPG Key Management:</strong> Automatic GPG key import and verification for Linux systems</li>
                            <li><strong>Cross-Platform Support:</strong> Support for all major package management systems</li>
                            <li><strong>User Attribution:</strong> Track which administrator added each repository</li>
                        </ul>
                    </div>
                </section>

                <section class="endpoint-section">
                    <h2>Repository Management</h2>

                    <div class="endpoint">
                        <div class="endpoint-header">
                            <span class="method post">POST</span>
                            <code>/api/third-party-repositories</code>
                        </div>
                        <p>Add a new third-party repository configuration. The repository will be automatically distributed to all hosts matching the specified OS name and version.</p>
                        <div class="auth-required">ðŸ”’ Authentication Required (Admin)</div>

                        <h4>Request Body</h4>
                        <div class="code-block">
                            <pre><code>{
  "os_name": "Ubuntu",
  "os_version": "24.04",
  "repository_config": "deb [arch=amd64] https://download.docker.com/linux/ubuntu focal stable",
  "gpg_key_url": "https://download.docker.com/linux/ubuntu/gpg",
  "gpg_key_content": null
}</code></pre>
                        </div>

                        <h4>Parameters</h4>
                        <table class="params-table">
                            <thead>
                                <tr>
                                    <th>Parameter</th>
                                    <th>Type</th>
                                    <th>Required</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>os_name</code></td>
                                    <td>string</td>
                                    <td>Yes</td>
                                    <td>Target operating system name (e.g., "Ubuntu", "CentOS", "FreeBSD")</td>
                                </tr>
                                <tr>
                                    <td><code>os_version</code></td>
                                    <td>string</td>
                                    <td>Yes</td>
                                    <td>Specific OS version (e.g., "24.04", "9", "14.1")</td>
                                </tr>
                                <tr>
                                    <td><code>repository_config</code></td>
                                    <td>string</td>
                                    <td>Yes</td>
                                    <td>Complete repository configuration in OS-specific format</td>
                                </tr>
                                <tr>
                                    <td><code>gpg_key_url</code></td>
                                    <td>string</td>
                                    <td>No</td>
                                    <td>URL to GPG signing key for verification (Linux systems)</td>
                                </tr>
                                <tr>
                                    <td><code>gpg_key_content</code></td>
                                    <td>string</td>
                                    <td>No</td>
                                    <td>GPG key content directly (alternative to URL)</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>Response (201 Created)</h4>
                        <div class="code-block">
                            <pre><code>{
  "id": 1,
  "os_name": "Ubuntu",
  "os_version": "24.04",
  "repository_config": "deb [arch=amd64] https://download.docker.com/linux/ubuntu focal stable",
  "gpg_key_url": "https://download.docker.com/linux/ubuntu/gpg",
  "added_by": "admin@example.com",
  "created_at": "2024-10-08T10:00:00Z",
  "hosts_notified": 12
}</code></pre>
                        </div>

                        <h4>Error Responses</h4>
                        <div class="code-block">
                            <pre><code>400 Bad Request - Invalid repository configuration format
401 Unauthorized - Authentication required
403 Forbidden - Admin privileges required
500 Internal Server Error - Server error occurred</code></pre>
                        </div>
                    </div>

                    <div class="endpoint">
                        <div class="endpoint-header">
                            <span class="method get">GET</span>
                            <code>/api/third-party-repositories</code>
                        </div>
                        <p>List all configured third-party repositories.</p>
                        <div class="auth-required">ðŸ”’ Authentication Required</div>

                        <h4>Response (200 OK)</h4>
                        <div class="code-block">
                            <pre><code>[
  {
    "id": 1,
    "os_name": "Ubuntu",
    "os_version": "24.04",
    "repository_config": "deb [arch=amd64] https://download.docker.com/linux/ubuntu focal stable",
    "gpg_key_url": "https://download.docker.com/linux/ubuntu/gpg",
    "added_by": "admin@example.com",
    "created_at": "2024-10-08T10:00:00Z",
    "host_count": 12
  },
  {
    "id": 2,
    "os_name": "CentOS",
    "os_version": "9",
    "repository_config": "[docker]\nname=Docker Repository\nbaseurl=https://download.docker.com/linux/centos/9/x86_64/stable\nenabled=1\ngpgcheck=1",
    "gpg_key_url": "https://download.docker.com/linux/centos/gpg",
    "added_by": "admin@example.com",
    "created_at": "2024-10-08T11:00:00Z",
    "host_count": 8
  }
]</code></pre>
                        </div>
                    </div>

                    <div class="endpoint">
                        <div class="endpoint-header">
                            <span class="method get">GET</span>
                            <code>/api/third-party-repositories/{id}</code>
                        </div>
                        <p>Get details of a specific repository configuration.</p>
                        <div class="auth-required">ðŸ”’ Authentication Required</div>

                        <h4>Response (200 OK)</h4>
                        <div class="code-block">
                            <pre><code>{
  "id": 1,
  "os_name": "Ubuntu",
  "os_version": "24.04",
  "repository_config": "deb [arch=amd64] https://download.docker.com/linux/ubuntu focal stable",
  "gpg_key_url": "https://download.docker.com/linux/ubuntu/gpg",
  "gpg_key_content": null,
  "added_by": "admin@example.com",
  "created_at": "2024-10-08T10:00:00Z",
  "affected_hosts": [
    {
      "hostname": "web-server-01",
      "status": "applied",
      "applied_at": "2024-10-08T10:01:23Z"
    },
    {
      "hostname": "web-server-02",
      "status": "applied",
      "applied_at": "2024-10-08T10:01:45Z"
    }
  ]
}</code></pre>
                        </div>
                    </div>

                    <div class="endpoint">
                        <div class="endpoint-header">
                            <span class="method delete">DELETE</span>
                            <code>/api/third-party-repositories/{id}</code>
                        </div>
                        <p>Remove a repository configuration. This will remove the repository from all affected hosts and update their package cache.</p>
                        <div class="auth-required">ðŸ”’ Authentication Required (Admin)</div>

                        <h4>Response (200 OK)</h4>
                        <div class="code-block">
                            <pre><code>{
  "message": "Repository removed successfully",
  "hosts_notified": 12,
  "repository_id": 1
}</code></pre>
                        </div>

                        <h4>Error Responses</h4>
                        <div class="code-block">
                            <pre><code>401 Unauthorized - Authentication required
403 Forbidden - Admin privileges required
404 Not Found - Repository not found
500 Internal Server Error - Server error occurred</code></pre>
                        </div>
                    </div>
                </section>

                <section class="examples">
                    <h2>Usage Examples</h2>

                    <h3>Add Docker Repository to Ubuntu Hosts</h3>
                    <div class="code-block">
                        <pre><code>curl -X POST https://sysmanage.example.com/api/third-party-repositories \
  -H "Authorization: Bearer $API_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "os_name": "Ubuntu",
    "os_version": "24.04",
    "repository_config": "deb [arch=amd64] https://download.docker.com/linux/ubuntu focal stable",
    "gpg_key_url": "https://download.docker.com/linux/ubuntu/gpg"
  }'</code></pre>
                    </div>

                    <h3>Add EPEL Repository to RHEL Hosts</h3>
                    <div class="code-block">
                        <pre><code>curl -X POST https://sysmanage.example.com/api/third-party-repositories \
  -H "Authorization: Bearer $API_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "os_name": "RHEL",
    "os_version": "9",
    "repository_config": "[epel]\nname=Extra Packages for Enterprise Linux 9 - $basearch\nbaseurl=https://download.fedoraproject.org/pub/epel/9/Everything/$basearch/\nenabled=1\ngpgcheck=1",
    "gpg_key_url": "https://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-9"
  }'</code></pre>
                    </div>

                    <h3>List All Repositories</h3>
                    <div class="code-block">
                        <pre><code>curl -X GET https://sysmanage.example.com/api/third-party-repositories \
  -H "Authorization: Bearer $API_TOKEN"</code></pre>
                    </div>

                    <h3>Remove a Repository</h3>
                    <div class="code-block">
                        <pre><code>curl -X DELETE https://sysmanage.example.com/api/third-party-repositories/1 \
  -H "Authorization: Bearer $API_TOKEN"</code></pre>
                    </div>
                </section>

                <section class="platform-formats">
                    <h2>Repository Configuration Formats by Platform</h2>

                    <h3>Debian/Ubuntu</h3>
                    <div class="code-block">
                        <pre><code>deb [arch=amd64] https://download.docker.com/linux/ubuntu focal stable</code></pre>
                    </div>

                    <h3>RHEL/CentOS/Fedora</h3>
                    <div class="code-block">
                        <pre><code>[docker-ce]
name=Docker CE Stable - $basearch
baseurl=https://download.docker.com/linux/centos/9/$basearch/stable
enabled=1
gpgcheck=1</code></pre>
                    </div>

                    <h3>openSUSE/SLES</h3>
                    <div class="code-block">
                        <pre><code>https://download.opensuse.org/repositories/Virtualization:/containers/15.4/</code></pre>
                    </div>

                    <h3>FreeBSD</h3>
                    <div class="code-block">
                        <pre><code>https://pkg.example.com/freebsd/${ABI}/latest</code></pre>
                    </div>

                    <h3>macOS (Homebrew)</h3>
                    <div class="code-block">
                        <pre><code>user/tap-name
https://github.com/user/homebrew-tap-name</code></pre>
                    </div>

                    <h3>Windows (Chocolatey)</h3>
                    <div class="code-block">
                        <pre><code>https://chocolatey.example.com/repository</code></pre>
                    </div>
                </section>

                <section class="best-practices-api">
                    <h2>API Best Practices</h2>

                    <h3>Security Considerations</h3>
                    <ul>
                        <li><strong>HTTPS Only:</strong> Always use HTTPS repository URLs to prevent man-in-the-middle attacks</li>
                        <li><strong>GPG Keys:</strong> Provide GPG keys for all Linux repositories to ensure package verification</li>
                        <li><strong>Verify Sources:</strong> Only add repositories from trusted, verified sources</li>
                        <li><strong>Admin Only:</strong> Repository management requires administrative privileges</li>
                    </ul>

                    <h3>Operational Best Practices</h3>
                    <ul>
                        <li><strong>Test First:</strong> Test repository configurations on non-production systems before adding</li>
                        <li><strong>Document Purpose:</strong> Maintain external documentation of why each repository was added</li>
                        <li><strong>Monitor Application:</strong> Check affected_hosts in API responses to verify successful distribution</li>
                        <li><strong>Version Control:</strong> Track API calls in version control or configuration management systems</li>
                    </ul>
                </section>
            </div>

            <div class="docs-footer">
                <div class="docs-navigation">
                    <h3>Related Documentation</h3>
                    <div class="nav-links">
                        <a href="../administration/third-party-repositories.html" class="nav-link">Third-Party Repositories Guide â†’</a>
                        <a href="packages.html" class="nav-link">Package Management API â†’</a>
                        <a href="hosts.html" class="nav-link">Host Management API â†’</a>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <!-- Footer injected automatically by components.js -->    <script src="/assets/js/components.js"></script>
    <script src="/assets/js/i18n.js"></script>
    <script src="/assets/js/navbar.js"></script>
    <script src="/assets/js/main.js"></script>
</body>
</html>
