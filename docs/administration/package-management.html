<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Package Management - SysManage Administration</title>
    <meta name="description" content="Complete guide to package installation and uninstallation in SysManage, including operation tracking and management.">
    <link rel="stylesheet" href="../../assets/css/style.css">
    <link rel="icon" type="image/svg+xml" href="../../assets/images/favicon.svg">
</head>
<body>
    <header class="site-header">
        <nav class="navbar">
            <div class="container">
                <div class="nav-brand">
                    <a href="../../">
                        <img src="../../assets/images/sysmanage-logo.svg" alt="SysManage" class="logo">
                    </a>
                </div>
                <div class="nav-menu">
                    <a href="../../#features" class="nav-link" data-i18n="nav.features" data-i18n-html>Features</a>
                    <a href="../../#getting-started" class="nav-link" data-i18n="nav.getting_started" data-i18n-html>Getting Started</a>
                    <a href="../" class="nav-link active" data-i18n="nav.documentation" data-i18n-html>Documentation</a>
                    <a href="../../config-builder.html" class="nav-link" data-i18n="nav.config_builder" data-i18n-html>Configuration Builder</a>
                    <a href="https://github.com/bceverly/sysmanage" class="nav-link" target="_blank" data-i18n="nav.github" data-i18n-html>GitHub</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="docs-main">
        <div class="container">
            <div class="docs-breadcrumb">
                <a href="../">Documentation</a> > <a href="./">Administration</a> > <span>Package Management</span>
            </div>

            <div class="docs-header">
                <h1>Package Management</h1>
                <p>Comprehensive guide to managing software packages across your infrastructure including installation, uninstallation, and operation tracking.</p>
            </div>

            <div class="docs-content">
                <section class="overview">
                    <h2>Overview</h2>
                    <p>SysManage provides a unified interface for managing software packages across multiple operating systems and package managers. The platform supports both installation and uninstallation operations with comprehensive tracking, logging, and status monitoring.</p>

                    <div class="feature-highlights">
                        <h3>Key Features</h3>
                        <ul>
                            <li><strong>Cross-Platform Support:</strong> Works with apt, yum/dnf, pkg (FreeBSD), pkg_add (OpenBSD), pkgin (NetBSD), and Homebrew</li>
                            <li><strong>Batch Operations:</strong> Install or uninstall multiple packages in a single operation</li>
                            <li><strong>Real-time Tracking:</strong> Monitor operation status and progress in real-time</li>
                            <li><strong>Comprehensive Logging:</strong> Detailed logs for all package operations</li>
                            <li><strong>User Attribution:</strong> Track which user initiated each operation</li>
                            <li><strong>Safety Features:</strong> Confirmation dialogs and rollback capabilities</li>
                        </ul>
                    </div>
                </section>

                <section class="package-installation">
                    <h2>Package Installation</h2>

                    <div class="operation-overview">
                        <h3>Installation Process</h3>
                        <p>Package installation in SysManage follows a structured workflow:</p>
                        <ol>
                            <li>User initiates installation from the web interface</li>
                            <li>Request is validated and queued on the server</li>
                            <li>Installation request is sent to the target agent via message queue</li>
                            <li>Agent downloads and installs the package using the appropriate package manager</li>
                            <li>Installation results are reported back and logged</li>
                            <li>User receives real-time status updates</li>
                        </ol>
                    </div>

                    <div class="web-interface-guide">
                        <h3>Using the Web Interface</h3>
                        <h4>Installing Individual Packages</h4>
                        <ol>
                            <li>Navigate to the host detail page</li>
                            <li>Go to the "Software Inventory" tab</li>
                            <li>Use the search functionality to find available packages</li>
                            <li>Click the "Install" button next to the desired package</li>
                            <li>Confirm the installation in the dialog</li>
                            <li>Monitor progress in the "Software Changes" tab</li>
                        </ol>

                        <h4>Bulk Package Installation</h4>
                        <p>SysManage supports installing multiple packages in a single operation through the API. This is efficient for system setup and bulk deployments.</p>
                    </div>

                    <div class="installation-tracking">
                        <h3>Installation Tracking</h3>
                        <p>Every installation operation is tracked with the following information:</p>
                        <ul>
                            <li><strong>Request ID:</strong> Unique UUID for the installation request</li>
                            <li><strong>Package Details:</strong> Name, version, and package manager</li>
                            <li><strong>User Attribution:</strong> Who requested the installation</li>
                            <li><strong>Timestamps:</strong> Request time, start time, and completion time</li>
                            <li><strong>Status:</strong> pending, queued, installing, completed, failed, cancelled</li>
                            <li><strong>Results:</strong> Success/failure status and installation logs</li>
                        </ul>
                    </div>
                </section>

                <section class="package-uninstallation">
                    <h2>Package Uninstallation</h2>

                    <div class="operation-overview">
                        <h3>Uninstallation Process</h3>
                        <p>Package uninstallation follows a similar but more safety-focused workflow:</p>
                        <ol>
                            <li>User initiates uninstallation from the software inventory</li>
                            <li>System displays confirmation dialog with package details</li>
                            <li>Request is validated and queued with operation type "uninstall"</li>
                            <li>Uninstallation request is sent to the target agent</li>
                            <li>Agent removes the package using the appropriate package manager</li>
                            <li>Uninstallation results are reported back and logged</li>
                            <li>Software inventory is updated to reflect changes</li>
                        </ol>
                    </div>

                    <div class="web-interface-guide">
                        <h3>Using the Web Interface for Uninstallation</h3>
                        <h4>Uninstalling Individual Packages</h4>
                        <ol>
                            <li>Navigate to the host detail page</li>
                            <li>Go to the "Software Inventory" tab</li>
                            <li>Find the installed package you want to remove</li>
                            <li>Click the "Uninstall" button next to the package</li>
                            <li><strong>Important:</strong> Carefully review the confirmation dialog</li>
                            <li>Confirm the uninstallation by clicking "Uninstall"</li>
                            <li>Monitor progress in the "Software Changes" tab</li>
                        </ol>

                        <div class="warning-box">
                            <h4>⚠️ Important Safety Considerations</h4>
                            <ul>
                                <li>Package uninstallation is irreversible through the UI</li>
                                <li>Removing system packages may cause system instability</li>
                                <li>Dependencies may be automatically removed by the package manager</li>
                                <li>Always test uninstallations in non-production environments first</li>
                                <li>Create system backups before removing critical packages</li>
                            </ul>
                        </div>

                        <h4>Bulk Package Uninstallation</h4>
                        <p>Multiple packages can be uninstalled in a single operation via the API. This is useful for:</p>
                        <ul>
                            <li>System cleanup and maintenance</li>
                            <li>Removing obsolete software suites</li>
                            <li>Standardizing system configurations</li>
                            <li>Security-driven package removal</li>
                        </ul>
                    </div>

                    <div class="uninstallation-tracking">
                        <h3>Uninstallation Tracking</h3>
                        <p>Uninstallation operations are tracked with the same detail as installations:</p>
                        <ul>
                            <li><strong>Operation Type:</strong> Clearly marked as "uninstall" in logs</li>
                            <li><strong>Package Information:</strong> Name, version, and dependencies removed</li>
                            <li><strong>Audit Trail:</strong> Complete record of who removed what and when</li>
                            <li><strong>Command Output:</strong> Full package manager output for troubleshooting</li>
                            <li><strong>Status Tracking:</strong> Real-time status updates during removal</li>
                        </ul>
                    </div>
                </section>

                <section class="operation-monitoring">
                    <h2>Operation Monitoring and Tracking</h2>

                    <div class="software-changes-tab">
                        <h3>Software Changes Tab</h3>
                        <p>The "Software Changes" tab (previously "Software Installs") provides a comprehensive view of all package operations:</p>

                        <h4>Key Information Displayed</h4>
                        <ul>
                            <li><strong>Operation Type:</strong> Install or Uninstall label with appropriate styling</li>
                            <li><strong>Package Name:</strong> Name of the package that was modified</li>
                            <li><strong>Version:</strong> Package version involved in the operation</li>
                            <li><strong>Status:</strong> Current status of the operation</li>
                            <li><strong>Requested By:</strong> User who initiated the operation</li>
                            <li><strong>Timestamps:</strong> When the operation was requested and completed</li>
                            <li><strong>Results:</strong> Success/failure status and error details if applicable</li>
                        </ul>

                        <h4>Status Values</h4>
                        <ul>
                            <li><strong>pending:</strong> Operation queued but not yet started</li>
                            <li><strong>in_progress:</strong> Agent is currently processing the operation</li>
                            <li><strong>completed:</strong> Operation finished successfully</li>
                            <li><strong>failed:</strong> Operation encountered an error</li>
                            <li><strong>cancelled:</strong> Operation was cancelled before completion</li>
                        </ul>
                    </div>

                    <div class="real-time-updates">
                        <h3>Real-time Status Updates</h3>
                        <p>SysManage provides real-time updates through WebSocket connections:</p>
                        <ul>
                            <li>Status changes are immediately reflected in the web interface</li>
                            <li>Success/failure notifications appear as snackbar messages</li>
                            <li>Progress indicators show operation advancement</li>
                            <li>Error messages provide immediate feedback for failed operations</li>
                        </ul>
                    </div>

                    <div class="logging-and-auditing">
                        <h3>Logging and Auditing</h3>
                        <p>All package operations are comprehensively logged for auditing and troubleshooting:</p>

                        <h4>Database Logging</h4>
                        <ul>
                            <li><strong>Operation Records:</strong> Stored in software_installation_log table</li>
                            <li><strong>Request Tracking:</strong> UUID-based tracking for grouped operations</li>
                            <li><strong>User Attribution:</strong> Every operation linked to the requesting user</li>
                            <li><strong>Detailed Metadata:</strong> Package manager, versions, timestamps</li>
                        </ul>

                        <h4>Agent Logging</h4>
                        <ul>
                            <li><strong>Command Execution:</strong> Full package manager command output</li>
                            <li><strong>Error Details:</strong> Detailed error messages and stack traces</li>
                            <li><strong>Environment Info:</strong> System state during operation execution</li>
                            <li><strong>Dependency Information:</strong> Details about packages installed/removed as dependencies</li>
                        </ul>
                    </div>
                </section>

                <section class="package-managers">
                    <h2>Supported Package Managers</h2>

                    <div class="package-manager-details">
                        <h3>APT (Debian/Ubuntu)</h3>
                        <ul>
                            <li><strong>Installation:</strong> <code>apt-get install -y package-name</code></li>
                            <li><strong>Uninstallation:</strong> <code>apt-get remove -y package-name</code></li>
                            <li><strong>Features:</strong> Automatic dependency resolution, security updates</li>
                            <li><strong>Notes:</strong> Uses DEBIAN_FRONTEND=noninteractive for automation</li>
                        </ul>

                        <h3>YUM/DNF (RHEL/CentOS/Fedora)</h3>
                        <ul>
                            <li><strong>Installation:</strong> <code>yum install -y package-name</code> or <code>dnf install -y package-name</code></li>
                            <li><strong>Uninstallation:</strong> <code>yum remove -y package-name</code> or <code>dnf remove -y package-name</code></li>
                            <li><strong>Features:</strong> Repository management, group installations</li>
                            <li><strong>Notes:</strong> Automatic detection between yum and dnf</li>
                        </ul>

                        <h3>PKG (FreeBSD)</h3>
                        <ul>
                            <li><strong>Installation:</strong> <code>pkg install -y package-name</code></li>
                            <li><strong>Uninstallation:</strong> <code>pkg delete -y package-name</code></li>
                            <li><strong>Features:</strong> Binary package management, ports collection integration</li>
                            <li><strong>Notes:</strong> Supports both binary packages and ports</li>
                        </ul>

                        <h3>PKG_ADD (OpenBSD)</h3>
                        <ul>
                            <li><strong>Installation:</strong> <code>pkg_add package-name</code></li>
                            <li><strong>Uninstallation:</strong> <code>pkg_delete package-name</code></li>
                            <li><strong>Features:</strong> Simple, secure package management</li>
                            <li><strong>Notes:</strong> Uses release-specific package repositories</li>
                        </ul>

                        <h3>Homebrew (macOS)</h3>
                        <ul>
                            <li><strong>Installation:</strong> <code>brew install package-name</code></li>
                            <li><strong>Uninstallation:</strong> <code>brew uninstall package-name</code></li>
                            <li><strong>Features:</strong> Source and binary packages, cask support</li>
                            <li><strong>Notes:</strong> Requires user-space installation</li>
                        </ul>
                    </div>

                    <div class="auto-detection">
                        <h3>Automatic Package Manager Detection</h3>
                        <p>SysManage agents automatically detect the appropriate package manager based on:</p>
                        <ul>
                            <li>Operating system type and version</li>
                            <li>Available package manager binaries</li>
                            <li>System configuration and package database presence</li>
                            <li>User-specified preferences in configuration</li>
                        </ul>
                    </div>
                </section>

                <section class="database-schema">
                    <h2>Database Schema</h2>

                    <div class="schema-overview">
                        <h3>Software Installation Log Table</h3>
                        <p>The <code>software_installation_log</code> table tracks all package operations:</p>

                        <div class="code-block">
                            <pre><code>CREATE TABLE software_installation_log (
    id SERIAL PRIMARY KEY,
    host_id INTEGER REFERENCES host(id) ON DELETE CASCADE,

    -- Package details
    package_name VARCHAR(255) NOT NULL,
    package_manager VARCHAR(50) NOT NULL,
    requested_version VARCHAR(100),
    requested_by VARCHAR(100) NOT NULL,

    -- Request tracking
    installation_id VARCHAR(36) NOT NULL UNIQUE,  -- UUID
    status VARCHAR(20) DEFAULT 'pending',
    operation_type VARCHAR(20) DEFAULT 'install',  -- NEW: install/uninstall

    -- Timestamps
    requested_at TIMESTAMP WITH TIME ZONE NOT NULL,
    queued_at TIMESTAMP WITH TIME ZONE,
    started_at TIMESTAMP WITH TIME ZONE,
    completed_at TIMESTAMP WITH TIME ZONE,

    -- Results
    installed_version VARCHAR(100),
    success BOOLEAN,
    error_message TEXT,
    installation_log TEXT,

    -- Metadata
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);</code></pre>
                        </div>

                        <h4>Key Schema Changes for Uninstall Support</h4>
                        <ul>
                            <li><strong>operation_type column:</strong> Distinguishes between 'install' and 'uninstall' operations</li>
                            <li><strong>Enhanced indexing:</strong> Optimized queries for operation type filtering</li>
                            <li><strong>Backward compatibility:</strong> Existing records default to 'install' operation</li>
                        </ul>
                    </div>

                    <div class="uuid-tracking">
                        <h3>UUID-based Request Tracking</h3>
                        <p>Package operations use UUID-based tracking for grouped operations:</p>

                        <div class="code-block">
                            <pre><code>CREATE TABLE installation_requests (
    id VARCHAR(36) PRIMARY KEY,  -- UUID
    host_id INTEGER REFERENCES host(id) ON DELETE CASCADE,
    requested_by VARCHAR(100) NOT NULL,
    requested_at TIMESTAMP WITH TIME ZONE NOT NULL,
    completed_at TIMESTAMP WITH TIME ZONE,
    status VARCHAR(20) DEFAULT 'pending',
    result_log TEXT,
    created_at TIMESTAMP WITH TIME ZONE NOT NULL,
    updated_at TIMESTAMP WITH TIME ZONE NOT NULL
);

CREATE TABLE installation_packages (
    id SERIAL PRIMARY KEY,
    installation_request_id VARCHAR(36) REFERENCES installation_requests(id) ON DELETE CASCADE,
    package_name VARCHAR(255) NOT NULL,
    package_manager VARCHAR(50) NOT NULL
);</code></pre>
                        </div>

                        <h4>Benefits of UUID Tracking</h4>
                        <ul>
                            <li>Groups multiple packages into a single operation</li>
                            <li>Enables atomic success/failure for batch operations</li>
                            <li>Simplifies progress tracking and reporting</li>
                            <li>Provides clear audit trail for complex operations</li>
                        </ul>
                    </div>
                </section>

                <section class="best-practices">
                    <h2>Best Practices</h2>

                    <div class="operational-practices">
                        <h3>Operational Best Practices</h3>
                        <ul>
                            <li><strong>Test First:</strong> Always test package operations in development/staging environments</li>
                            <li><strong>Backup Systems:</strong> Create system snapshots before major package changes</li>
                            <li><strong>Read Dependencies:</strong> Review package dependencies before uninstallation</li>
                            <li><strong>Monitor Resources:</strong> Ensure adequate disk space and memory before operations</li>
                            <li><strong>Schedule Wisely:</strong> Perform major package operations during maintenance windows</li>
                            <li><strong>Document Changes:</strong> Maintain records of package modifications for compliance</li>
                        </ul>
                    </div>

                    <div class="security-practices">
                        <h3>Security Best Practices</h3>
                        <ul>
                            <li><strong>Role-based Access:</strong> Restrict package management to authorized users</li>
                            <li><strong>Audit Logging:</strong> Review package operation logs regularly</li>
                            <li><strong>Source Verification:</strong> Use trusted package repositories only</li>
                            <li><strong>Vulnerability Management:</strong> Keep security-critical packages updated</li>
                            <li><strong>Change Control:</strong> Implement approval workflows for critical systems</li>
                            <li><strong>Incident Response:</strong> Have rollback procedures for failed operations</li>
                        </ul>
                    </div>

                    <div class="performance-practices">
                        <h3>Performance Best Practices</h3>
                        <ul>
                            <li><strong>Batch Operations:</strong> Group related packages into single operations</li>
                            <li><strong>Repository Caching:</strong> Maintain local package mirrors for large deployments</li>
                            <li><strong>Network Optimization:</strong> Schedule operations during low-traffic periods</li>
                            <li><strong>Resource Planning:</strong> Consider system load when planning operations</li>
                            <li><strong>Parallel Execution:</strong> Use agent concurrency for multiple hosts</li>
                            <li><strong>Progress Monitoring:</strong> Monitor operation progress to identify bottlenecks</li>
                        </ul>
                    </div>
                </section>
            </div>

            <div class="docs-footer">
                <div class="docs-navigation">
                    <h3>Related Documentation</h3>
                    <div class="nav-links">
                        <a href="../api/packages.html" class="nav-link">Package Management API →</a>
                        <a href="monitoring.html" class="nav-link">Monitoring & Alerts →</a>
                        <a href="../getting-started/basic-management.html" class="nav-link">Basic Management Guide →</a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2024 SysManage. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="../../assets/js/navbar.js"></script>
    <script src="../../assets/js/main.js"></script>
    <script src="../../assets/js/i18n.js"></script>
</body>
</html>